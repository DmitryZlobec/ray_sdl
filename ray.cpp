/*This source code copyrighted by Lazy Foo' Productions 2004-2024
and may not be redistributed without written permission.*/

//Using SDL and standard IO
#include <SDL.h>
#include <stdio.h>
#include <cstdlib>
#include <time.h>
#include <SDL_ttf.h>
#include <string>
#undef main
#define _GBORDER 1
#define _GFILLINTERIOR 0

//Screen dimension constants
const int SCREEN_WIDTH = 640;
const int SCREEN_HEIGHT = 480;

//The window we'll be rendering to
SDL_Window* window = NULL;

//The surface contained by the window
SDL_Surface* screenSurface = NULL;


SDL_Renderer* renderer = NULL;

SDL_Texture* texture, * text;
TTF_Font* font;


int color = 0;
int global_x, global_y;
int text_x, text_y;

void _setcolor(int new_color);
void _moveto(int x1, int y1);
int _setpixel(int x, int y);
int _lineto(int x2, int y2);
int _rectangle(int order, int x1, int y1, int x2, int y2);

int _settextposition(int x1, int y1);
void tprintf(const char*);


// D E F I N E S /////////////////////////////////////////////////////////////

// #define DEBUG 1

#define OVERBOARD          48 // the absolute closest a player can get to a wall

#define INTERSECTION_FOUND 1

// constants used to represent angles

#define ANGLE_0     0
#define ANGLE_1     5
#define ANGLE_2     10
#define ANGLE_4     20
#define ANGLE_5     25
#define ANGLE_6     30
#define ANGLE_15    80
#define ANGLE_30    160
#define ANGLE_45    240
#define ANGLE_60    320
#define ANGLE_90    480
#define ANGLE_135   720
#define ANGLE_180   960
#define ANGLE_225   1200
#define ANGLE_270   1440
#define ANGLE_315   1680
#define ANGLE_360   1920

#define WORLD_ROWS    16        // number of rows in the game world
#define WORLD_COLUMNS 16        // number of columns in the game world
#define CELL_X_SIZE   64        // size of a cell in the gamw world
#define CELL_Y_SIZE   64

// size of overall game world

#define WORLD_X_SIZE  (WORLD_COLUMNS * CELL_X_SIZE)
#define WORLD_Y_SIZE  (WORLD_ROWS    * CELL_Y_SIZE)

// G L O B A L S /////////////////////////////////////////////////////////////

//unsigned int * clock = (unsigned int *)0x0000046C; // pointer to internal
// 18.2 clicks/sec


// world map of nxn cells, each cell is 64x64 pixels

char world[WORLD_ROWS][WORLD_COLUMNS] = { 
	{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
	{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
	{1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1},
	{1,0,0,1,0,0,0,1,0,1,0,1,0,1,0,1},
	{1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1},
	{1,0,0,1,0,0,1,1,0,0,0,0,0,0,0,1},
	{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
	{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
	{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
	{1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1},
	{1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1},
	{1,0,0,1,1,1,0,0,0,0,0,0,1,0,0,1},
	{1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1},
	{1,0,0,1,1,1,1,1,1,1,1,0,1,0,0,1},
	{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
	{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
};       // pointer to matrix of cells that make up
// world

float  tan_table[1921] = { 0.000327,0.003600,0.006872,0.010145,0.013418,0.016691,0.019965,0.023239,0.026513,0.029788,0.033064,0.036341,0.039618,0.042896,0.046175,0.049455,0.052736,0.056018,0.059301,0.062586,0.065872,0.069159,0.072448,0.075739,0.079031,0.082325,0.085620,0.088918,0.092217,0.095518,0.098822,0.102127,0.105435,0.108745,0.112057,0.115372,0.118690,0.122009,0.125332,0.128657,0.131985,0.135316,0.138650,0.141987,0.145327,0.148670,0.152017,0.155367,0.158720,0.162077,0.165437,0.168801,0.172168,0.175540,0.178915,0.182294,0.185678,0.189065,0.192456,0.195852,0.199253,0.202657,0.206066,0.209480,0.212899,0.216322,0.219750,0.223183,0.226621,0.230064,0.233512,0.236966,0.240425,0.243889,0.247359,0.250835,0.254316,0.257803,0.261296,0.264795,0.268300,0.271811,0.275328,0.278852,0.282382,0.285919,0.289462,0.293013,0.296569,0.300133,0.303704,0.307282,0.310867,0.314459,0.318059,0.321667,0.325282,0.328904,0.332535,0.336173,0.339819,0.343474,0.347136,0.350807,0.354487,0.358175,0.361872,0.365577,0.369291,0.373015,0.376747,0.380489,0.384239,0.388000,0.391770,0.395549,0.399339,0.403138,0.406948,0.410767,0.414597,0.418437,0.422288,0.426149,0.430022,0.433905,0.437799,0.441704,0.445621,0.449549,0.453489,0.457440,0.461403,0.465378,0.469366,0.473365,0.477377,0.481402,0.485439,0.489489,0.493552,0.497629,0.501718,0.505821,0.509938,0.514068,0.518212,0.522371,0.526543,0.530730,0.534932,0.539148,0.543379,0.547626,0.551887,0.556164,0.560457,0.564765,0.569089,0.573430,0.577787,0.582160,0.586550,0.590957,0.595381,0.599822,0.604280,0.608757,0.613251,0.617763,0.622294,0.626843,0.631411,0.635997,0.640603,0.645228,0.649873,0.654537,0.659222,0.663927,0.668652,0.673398,0.678165,0.682953,0.687763,0.692594,0.697447,0.702323,0.707221,0.712142,0.717085,0.722052,0.727043,0.732057,0.737095,0.742158,0.747245,0.752357,0.757495,0.762658,0.767847,0.773062,0.778304,0.783572,0.788867,0.794190,0.799540,0.804919,0.810326,0.815762,0.821227,0.826721,0.832245,0.837799,0.843384,0.849000,0.854647,0.860325,0.866036,0.871779,0.877555,0.883365,0.889208,0.895085,0.900997,0.906943,0.912925,0.918943,0.924997,0.931088,0.937217,0.943383,0.949587,0.955829,0.962111,0.968433,0.974795,0.981197,0.987641,0.994127,1.000655,1.007225,1.013840,1.020498,1.027201,1.033949,1.040743,1.047583,1.054471,1.061406,1.068390,1.075422,1.082504,1.089637,1.096820,1.104056,1.111344,1.118685,1.126080,1.133529,1.141034,1.148596,1.156214,1.163891,1.171626,1.179420,1.187275,1.195192,1.203170,1.211211,1.219317,1.227487,1.235724,1.244027,1.252398,1.260838,1.269348,1.277929,1.286582,1.295308,1.304109,1.312985,1.321937,1.330968,1.340077,1.349266,1.358537,1.367891,1.377329,1.386853,1.396463,1.406162,1.415950,1.425829,1.435801,1.445868,1.456030,1.466289,1.476647,1.487105,1.497666,1.508331,1.519102,1.529981,1.540969,1.552068,1.563280,1.574608,1.586054,1.597618,1.609305,1.621115,1.633051,1.645115,1.657310,1.669638,1.682101,1.694703,1.707444,1.720330,1.733361,1.746540,1.759871,1.773356,1.787000,1.800803,1.814770,1.828905,1.843209,1.857687,1.872342,1.887178,1.902197,1.917406,1.932806,1.948402,1.964199,1.980200,1.996409,2.012833,2.029473,2.046336,2.063427,2.080750,2.098310,2.116114,2.134165,2.152470,2.171036,2.189867,2.208969,2.228350,2.248016,2.267973,2.288229,2.308790,2.329664,2.350860,2.372383,2.394244,2.416450,2.439009,2.461932,2.485228,2.508904,2.532974,2.557446,2.582330,2.607639,2.633384,2.659575,2.686228,2.713353,2.740963,2.769074,2.797699,2.826852,2.856550,2.886809,2.917644,2.949075,2.981117,3.013792,3.047117,3.081113,3.115802,3.151206,3.187347,3.224251,3.261942,3.300445,3.339790,3.380005,3.421117,3.463163,3.506172,3.550178,3.595220,3.641335,3.688560,3.736941,3.786520,3.837342,3.889458,3.942917,3.997773,4.054084,4.111910,4.171311,4.232359,4.295122,4.359672,4.426092,4.494462,4.564877,4.637427,4.712210,4.789339,4.868923,4.951082,5.035950,5.123663,5.214364,5.308217,5.405388,5.506056,5.610422,5.718691,5.831087,5.947859,6.069268,6.195592,6.327150,6.464271,6.607314,6.756684,6.912810,7.076157,7.247254,7.426664,7.615006,7.812982,8.021338,8.240937,8.472709,8.717691,8.977071,9.252151,9.544400,9.855504,10.187345,10.542061,10.922141,11.330398,11.770080,12.245008,12.759586,13.318991,13.929404,14.598126,15.333920,16.147488,17.051838,18.063044,19.201349,20.492302,21.968792,23.674086,25.665804,28.022686,30.855585,34.324715,38.671978,44.279018,51.786083,62.357166,78.348816,105.367287,160.826675,339.527588,-3056.664307,-277.800690,-145.511078,-98.570892,-74.526901,-59.911625,-50.088234,-43.031422,-37.716785,-33.570110,-30.244217,-27.517395,-25.241188,-23.312256,-21.656778,-20.220476,-18.962416,-17.851370,-16.863007,-15.977989,-15.180953,-14.459336,-13.802925,-13.203273,-12.653275,-12.147013,-11.679479,-11.246353,-10.843976,-10.469193,-10.119226,-9.791696,-9.484515,-9.195818,-8.923989,-8.667596,-8.425338,-8.196081,-7.978808,-7.772586,-7.576594,-7.390092,-7.212393,-7.042888,-6.881026,-6.726288,-6.578215,-6.436388,-6.300408,-6.169921,-6.044605,-5.924145,-5.808272,-5.696717,-5.589246,-5.485639,-5.385683,-5.289188,-5.195982,-5.105888,-5.018756,-4.934443,-4.852806,-4.773722,-4.697073,-4.622743,-4.550628,-4.480632,-4.412656,-4.346616,-4.282430,-4.220016,-4.159303,-4.100223,-4.042704,-3.986688,-3.932117,-3.878930,-3.827077,-3.776508,-3.727172,-3.679027,-3.632025,-3.586128,-3.541298,-3.497492,-3.454679,-3.412824,-3.371892,-3.331853,-3.292680,-3.254340,-3.216809,-3.180061,-3.144068,-3.108809,-3.074261,-3.040400,-3.007206,-2.974660,-2.942741,-2.911431,-2.880713,-2.850567,-2.820979,-2.791933,-2.763412,-2.735402,-2.707890,-2.680861,-2.654302,-2.628200,-2.602543,-2.577321,-2.552519,-2.528129,-2.504139,-2.480539,-2.457319,-2.434470,-2.411981,-2.389845,-2.368053,-2.346595,-2.325464,-2.304654,-2.284154,-2.263958,-2.244061,-2.224452,-2.205127,-2.186080,-2.167302,-2.148789,-2.130535,-2.112534,-2.094780,-2.077267,-2.059991,-2.042946,-2.026127,-2.009532,-1.993152,-1.976984,-1.961024,-1.945267,-1.929711,-1.914350,-1.899179,-1.884196,-1.869397,-1.854777,-1.840334,-1.826065,-1.811964,-1.798030,-1.784259,-1.770647,-1.757193,-1.743893,-1.730743,-1.717741,-1.704885,-1.692171,-1.679598,-1.667162,-1.654861,-1.642692,-1.630654,-1.618743,-1.606958,-1.595297,-1.583756,-1.572334,-1.561029,-1.549839,-1.538763,-1.527797,-1.516940,-1.506190,-1.495546,-1.485005,-1.474568,-1.464229,-1.453990,-1.443847,-1.433800,-1.423847,-1.413986,-1.404215,-1.394534,-1.384941,-1.375435,-1.366014,-1.356677,-1.347422,-1.338249,-1.329155,-1.320140,-1.311204,-1.302343,-1.293557,-1.284846,-1.276207,-1.267640,-1.259145,-1.250719,-1.242361,-1.234071,-1.225848,-1.217691,-1.209598,-1.201569,-1.193604,-1.185699,-1.177857,-1.170074,-1.162351,-1.154686,-1.147079,-1.139529,-1.132035,-1.124597,-1.117212,-1.109882,-1.102605,-1.095380,-1.088206,-1.081084,-1.074012,-1.066989,-1.060015,-1.053090,-1.046212,-1.039381,-1.032596,-1.025857,-1.019163,-1.012513,-1.005908,-0.999346,-0.992827,-0.986349,-0.979914,-0.973519,-0.967166,-0.960852,-0.954578,-0.948343,-0.942146,-0.935988,-0.929868,-0.923784,-0.917737,-0.911726,-0.905751,-0.899812,-0.893907,-0.888037,-0.882200,-0.876398,-0.870628,-0.864891,-0.859187,-0.853515,-0.847874,-0.842265,-0.836686,-0.831138,-0.825620,-0.820131,-0.814672,-0.809242,-0.803841,-0.798468,-0.793123,-0.787806,-0.782516,-0.777253,-0.772017,-0.766807,-0.761624,-0.756466,-0.751333,-0.746226,-0.741143,-0.736086,-0.731052,-0.726043,-0.721057,-0.716095,-0.711156,-0.706240,-0.701346,-0.696475,-0.691626,-0.686799,-0.681994,-0.677210,-0.672447,-0.667705,-0.662984,-0.658283,-0.653603,-0.648943,-0.644302,-0.639680,-0.635078,-0.630496,-0.625932,-0.621386,-0.616859,-0.612351,-0.607860,-0.603387,-0.598932,-0.594495,-0.590074,-0.585671,-0.581284,-0.576914,-0.572561,-0.568223,-0.563902,-0.559597,-0.555308,-0.551034,-0.546776,-0.542532,-0.538304,-0.534090,-0.529892,-0.525708,-0.521538,-0.517383,-0.513241,-0.509113,-0.504999,-0.500899,-0.496812,-0.492739,-0.488678,-0.484631,-0.480596,-0.476574,-0.472565,-0.468567,-0.464582,-0.460610,-0.456649,-0.452700,-0.448763,-0.444837,-0.440922,-0.437019,-0.433127,-0.429246,-0.425376,-0.421517,-0.417668,-0.413830,-0.410002,-0.406185,-0.402378,-0.398580,-0.394793,-0.391015,-0.387247,-0.383489,-0.379740,-0.376000,-0.372269,-0.368548,-0.364835,-0.361132,-0.357437,-0.353750,-0.350073,-0.346403,-0.342742,-0.339089,-0.335445,-0.331808,-0.328179,-0.324558,-0.320945,-0.317339,-0.313740,-0.310149,-0.306566,-0.302989,-0.299420,-0.295858,-0.292302,-0.288753,-0.285211,-0.281676,-0.278147,-0.274625,-0.271108,-0.267598,-0.264095,-0.260597,-0.257105,-0.253619,-0.250139,-0.246665,-0.243196,-0.239733,-0.236275,-0.232822,-0.229375,-0.225933,-0.222496,-0.219064,-0.215637,-0.212215,-0.208797,-0.205384,-0.201976,-0.198572,-0.195173,-0.191778,-0.188387,-0.185001,-0.181618,-0.178240,-0.174865,-0.171495,-0.168128,-0.164764,-0.161405,-0.158049,-0.154697,-0.151347,-0.148002,-0.144659,-0.141320,-0.137983,-0.134650,-0.131320,-0.127992,-0.124667,-0.121345,-0.118026,-0.114709,-0.111395,-0.108083,-0.104773,-0.101466,-0.098161,-0.094858,-0.091557,-0.088258,-0.084961,-0.081666,-0.078373,-0.075081,-0.071791,-0.068502,-0.065215,-0.061929,-0.058645,-0.055362,-0.052080,-0.048799,-0.045519,-0.042240,-0.038962,-0.035685,-0.032409,-0.029133,-0.025859,-0.022584,-0.019310,-0.016037,-0.012763,-0.009490,-0.006218,-0.002945,0.000327,0.003600,0.006872,0.010145,0.013418,0.016691,0.019965,0.023239,0.026513,0.029788,0.033064,0.036341,0.039618,0.042896,0.046175,0.049455,0.052736,0.056018,0.059301,0.062586,0.065872,0.069159,0.072448,0.075739,0.079031,0.082325,0.085620,0.088918,0.092217,0.095518,0.098822,0.102127,0.105435,0.108745,0.112057,0.115372,0.118690,0.122010,0.125332,0.128657,0.131985,0.135316,0.138650,0.141987,0.145327,0.148670,0.152017,0.155367,0.158720,0.162077,0.165437,0.168801,0.172168,0.175540,0.178915,0.182294,0.185677,0.189065,0.192456,0.195852,0.199253,0.202657,0.206066,0.209480,0.212899,0.216322,0.219750,0.223183,0.226621,0.230064,0.233512,0.236966,0.240425,0.243889,0.247359,0.250835,0.254316,0.257803,0.261296,0.264795,0.268300,0.271811,0.275329,0.278852,0.282383,0.285919,0.289462,0.293013,0.296569,0.300133,0.303704,0.307282,0.310867,0.314459,0.318059,0.321667,0.325281,0.328904,0.332534,0.336173,0.339819,0.343474,0.347136,0.350807,0.354487,0.358175,0.361872,0.365577,0.369291,0.373014,0.376747,0.380489,0.384240,0.388000,0.391770,0.395549,0.399339,0.403138,0.406948,0.410767,0.414597,0.418437,0.422288,0.426149,0.430022,0.433905,0.437799,0.441704,0.445621,0.449549,0.453489,0.457440,0.461403,0.465378,0.469366,0.473365,0.477377,0.481402,0.485439,0.489489,0.493552,0.497629,0.501718,0.505821,0.509938,0.514068,0.518212,0.522371,0.526543,0.530730,0.534932,0.539148,0.543379,0.547626,0.551887,0.556164,0.560457,0.564765,0.569090,0.573430,0.577787,0.582160,0.586550,0.590957,0.595381,0.599822,0.604280,0.608757,0.613251,0.617763,0.622294,0.626843,0.631410,0.635997,0.640603,0.645228,0.649873,0.654538,0.659222,0.663927,0.668652,0.673398,0.678165,0.682953,0.687763,0.692594,0.697447,0.702323,0.707221,0.712141,0.717085,0.722052,0.727043,0.732057,0.737095,0.742158,0.747245,0.752357,0.757495,0.762658,0.767847,0.773062,0.778303,0.783572,0.788867,0.794190,0.799541,0.804919,0.810326,0.815762,0.821227,0.826721,0.832245,0.837799,0.843384,0.849000,0.854647,0.860326,0.866036,0.871779,0.877555,0.883365,0.889208,0.895085,0.900997,0.906943,0.912925,0.918943,0.924998,0.931089,0.937216,0.943382,0.949587,0.955829,0.962111,0.968433,0.974795,0.981197,0.987641,0.994127,1.000655,1.007225,1.013839,1.020498,1.027201,1.033949,1.040743,1.047583,1.054471,1.061406,1.068390,1.075422,1.082505,1.089637,1.096820,1.104056,1.111344,1.118685,1.126080,1.133529,1.141034,1.148596,1.156214,1.163891,1.171626,1.179421,1.187276,1.195192,1.203169,1.211211,1.219317,1.227487,1.235724,1.244027,1.252398,1.260838,1.269348,1.277929,1.286583,1.295308,1.304108,1.312984,1.321937,1.330967,1.340077,1.349266,1.358538,1.367892,1.377330,1.386853,1.396464,1.406161,1.415949,1.425829,1.435801,1.445867,1.456029,1.466289,1.476647,1.487106,1.497667,1.508332,1.519101,1.529980,1.540968,1.552068,1.563280,1.574608,1.586054,1.597619,1.609305,1.621115,1.633052,1.645116,1.657309,1.669637,1.682101,1.694702,1.707444,1.720329,1.733360,1.746540,1.759872,1.773357,1.787001,1.800804,1.814770,1.828904,1.843208,1.857686,1.872342,1.887177,1.902198,1.917406,1.932807,1.948403,1.964200,1.980199,1.996409,2.012832,2.029473,2.046336,2.063427,2.080750,2.098310,2.116114,2.134166,2.152472,2.171037,2.189865,2.208968,2.228350,2.248015,2.267973,2.288229,2.308790,2.329665,2.350860,2.372384,2.394245,2.416448,2.439008,2.461931,2.485227,2.508904,2.532974,2.557446,2.582330,2.607640,2.633384,2.659577,2.686229,2.713351,2.740962,2.769073,2.797698,2.826852,2.856550,2.886809,2.917645,2.949076,2.981119,3.013794,3.047119,3.081111,3.115801,3.151205,3.187347,3.224251,3.261942,3.300446,3.339791,3.380006,3.421120,3.463165,3.506168,3.550176,3.595218,3.641333,3.688560,3.736941,3.786520,3.837343,3.889459,3.942919,3.997776,4.054088,4.111906,4.171309,4.232357,4.295119,4.359671,4.426091,4.494464,4.564878,4.637429,4.712214,4.789343,4.868928,4.951078,5.035946,5.123659,5.214363,5.308216,5.405387,5.506059,5.610425,5.718694,5.831094,5.947867,6.069258,6.195586,6.327144,6.464264,6.607312,6.756683,6.912808,7.076161,7.247259,7.426669,7.615018,7.812994,8.021329,8.240927,8.472698,8.717689,8.977068,9.252149,9.544408,9.855513,10.187354,10.542085,10.922166,11.330363,11.770059,12.244985,12.759562,13.318985,13.929398,14.598120,15.333941,16.147511,17.051863,18.063112,19.201426,20.492188,21.968719,23.674002,25.665705,28.022661,30.855555,34.324818,38.672108,44.279186,51.786636,62.357971,78.350090,105.365608,160.822769,339.510193,-3056.961426,-277.803162,-145.511749,-98.570038,-74.526413,-59.911312,-50.087715,-43.031040,-37.717171,-33.570282,-30.244356,-27.517509,-25.241209,-23.312273,-21.656794,-20.220440,-18.962383,-17.851341,-16.862947,-15.977936,-15.180988,-14.459368,-13.802954,-13.203279,-12.653279,-12.147017,-11.679467,-11.246342,-10.843966,-10.469171,-10.119205,-9.791722,-9.484529,-9.195831,-8.924002,-8.667599,-8.425341,-8.196083,-7.978803,-7.772580,-7.576589,-7.390081,-7.212382,-7.042902,-6.881033,-6.726295,-6.578222,-6.436389,-6.300409,-6.169923,-6.044601,-5.924142,-5.808265,-5.696710,-5.589239,-5.485643,-5.385687,-5.289193,-5.195982,-5.105889,-5.018757,-4.934440,-4.852804,-4.773720,-4.697069,-4.622738,-4.550634,-4.480635,-4.412659,-4.346619,-4.282431,-4.220017,-4.159304,-4.100221,-4.042703,-3.986686,-3.932113,-3.878927,-3.827081,-3.776510,-3.727174,-3.679027,-3.632026,-3.586129,-3.541296,-3.497491,-3.454678,-3.412821,-3.371889,-3.331856,-3.292682,-3.254342,-3.216811,-3.180061,-3.144068,-3.108809,-3.074260,-3.040399,-3.007205,-2.974658,-2.942739,-2.911433,-2.880714,-2.850568,-2.820980,-2.791933,-2.763412,-2.735402,-2.707889,-2.680860,-2.654300,-2.628198,-2.602542,-2.577322,-2.552521,-2.528130,-2.504139,-2.480539,-2.457319,-2.434469,-2.411980,-2.389844,-2.368051,-2.346594,-2.325466,-2.304655,-2.284155,-2.263959,-2.244061,-2.224452,-2.205127,-2.186079,-2.167302,-2.148789,-2.130534,-2.112532,-2.094780,-2.077268,-2.059992,-2.042947,-2.026128,-2.009531,-1.993151,-1.976983,-1.961023,-1.945267,-1.929710,-1.914348,-1.899180,-1.884197,-1.869397,-1.854778,-1.840335,-1.826065,-1.811964,-1.798030,-1.784258,-1.770647,-1.757192,-1.743893,-1.730744,-1.717742,-1.704885,-1.692172,-1.679598,-1.667162,-1.654861,-1.642692,-1.630653,-1.618742,-1.606957,-1.595297,-1.583756,-1.572334,-1.561029,-1.549839,-1.538762,-1.527797,-1.516940,-1.506190,-1.495546,-1.485005,-1.474568,-1.464230,-1.453990,-1.443847,-1.433800,-1.423846,-1.413985,-1.404215,-1.394534,-1.384941,-1.375435,-1.366014,-1.356678,-1.347423,-1.338249,-1.329156,-1.320141,-1.311204,-1.302343,-1.293557,-1.284845,-1.276207,-1.267640,-1.259144,-1.250719,-1.242362,-1.234072,-1.225848,-1.217691,-1.209598,-1.201569,-1.193603,-1.185699,-1.177856,-1.170074,-1.162351,-1.154687,-1.147079,-1.139529,-1.132035,-1.124596,-1.117212,-1.109882,-1.102605,-1.095379,-1.088206,-1.081084,-1.074012,-1.066990,-1.060016,-1.053090,-1.046212,-1.039381,-1.032596,-1.025857,-1.019163,-1.012513,-1.005908,-0.999346,-0.992827,-0.986350,-0.979914,-0.973520,-0.967166,-0.960852,-0.954578,-0.948343,-0.942146,-0.935988,-0.929867,-0.923784,-0.917737,-0.911727,-0.905752,-0.899812,-0.893907,-0.888037,-0.882200,-0.876398,-0.870628,-0.864891,-0.859187,-0.853515,-0.847875,-0.842265,-0.836686,-0.831138,-0.825620,-0.820131,-0.814672,-0.809242,-0.803841,-0.798468,-0.793124,-0.787806,-0.782516,-0.777253,-0.772017,-0.766807,-0.761624,-0.756466,-0.751333,-0.746226,-0.741143,-0.736085,-0.731053,-0.726043,-0.721057,-0.716095,-0.711156,-0.706240,-0.701346,-0.696475,-0.691626,-0.686799,-0.681994,-0.677210,-0.672448,-0.667706,-0.662984,-0.658284,-0.653603,-0.648942,-0.644302,-0.639680,-0.635078,-0.630495,-0.625931,-0.621387,-0.616860,-0.612351,-0.607860,-0.603387,-0.598932,-0.594495,-0.590074,-0.585670,-0.581284,-0.576914,-0.572560,-0.568224,-0.563903,-0.559597,-0.555308,-0.551034,-0.546775,-0.542532,-0.538304,-0.534090,-0.529892,-0.525707,-0.521538,-0.517383,-0.513241,-0.509113,-0.505000,-0.500899,-0.496812,-0.492739,-0.488678,-0.484631,-0.480596,-0.476574,-0.472565,-0.468568,-0.464583,-0.460610,-0.456649,-0.452700,-0.448762,-0.444837,-0.440922,-0.437019,-0.433127,-0.429246,-0.425377,-0.421517,-0.417669,-0.413830,-0.410003,-0.406185,-0.402378,-0.398580,-0.394793,-0.391015,-0.387247,-0.383489,-0.379740,-0.376000,-0.372269,-0.368548,-0.364835,-0.361132,-0.357437,-0.353750,-0.350072,-0.346403,-0.342742,-0.339090,-0.335445,-0.331808,-0.328179,-0.324558,-0.320945,-0.317339,-0.313740,-0.310149,-0.306566,-0.302989,-0.299420,-0.295858,-0.292302,-0.288754,-0.285211,-0.281676,-0.278147,-0.274625,-0.271108,-0.267598,-0.264095,-0.260597,-0.257105,-0.253620,-0.250139,-0.246665,-0.243196,-0.239733,-0.236275,-0.232822,-0.229375,-0.225933,-0.222496,-0.219064,-0.215637,-0.212215,-0.208797,-0.205384,-0.201976,-0.198572,-0.195173,-0.191778,-0.188387,-0.185000,-0.181618,-0.178240,-0.174865,-0.171495,-0.168128,-0.164765,-0.161405,-0.158049,-0.154696,-0.151347,-0.148001,-0.144659,-0.141319,-0.137984,-0.134650,-0.131320,-0.127992,-0.124667,-0.121345,-0.118026,-0.114709,-0.111395,-0.108083,-0.104773,-0.101466,-0.098161,-0.094858,-0.091557,-0.088258,-0.084961,-0.081666,-0.078372,-0.075081,-0.071790,-0.068502,-0.065215,-0.061929,-0.058645,-0.055362,-0.052080,-0.048799,-0.045519,-0.042240,-0.038962,-0.035685,-0.032409,-0.029133,-0.025858,-0.022584,-0.019310,-0.016037,-0.012764,-0.009491,-0.006218,-0.002945,0.000327 };
// tangent tables used to compute initial };              // tangent tables used to compute initial
float inv_tan_table[1921] = { 3058.104004,277.777771,145.518036,98.570724,74.526756,59.912529,50.087654,43.031113,37.717346,33.570564,30.244373,27.517130,25.241053,23.312197,21.656740,20.220404,18.962379,17.851406,16.863123,15.978014,15.180957,14.459434,13.803003,13.203237,12.653263,12.146979,11.679514,11.246317,10.843987,10.469231,10.119205,9.791730,9.484517,9.195825,8.924029,8.667614,8.425310,8.196116,7.978808,7.772605,7.576619,7.390109,7.212405,7.042899,6.881034,6.726306,6.578212,6.436373,6.300403,6.169907,6.044597,5.924136,5.808280,5.696707,5.589246,5.485644,5.385667,5.289186,5.195992,5.105896,5.018745,4.934446,4.852814,4.773726,4.697063,4.622738,4.550626,4.480628,4.412654,4.346616,4.282435,4.220015,4.159301,4.100226,4.042707,3.986685,3.932116,3.878931,3.827077,3.776506,3.727171,3.679027,3.632031,3.586132,3.541302,3.497494,3.454685,3.412818,3.371897,3.331856,3.292680,3.254340,3.216810,3.180065,3.144071,3.108805,3.074255,3.040401,3.007202,2.974659,2.942743,2.911428,2.880715,2.850570,2.820978,2.791931,2.763408,2.735402,2.707891,2.680857,2.654301,2.628197,2.602547,2.577320,2.552518,2.528132,2.504138,2.480540,2.457316,2.434470,2.411981,2.389846,2.368052,2.346597,2.325462,2.304652,2.284153,2.263960,2.244059,2.224452,2.205125,2.186079,2.167303,2.148791,2.130533,2.112535,2.094780,2.077266,2.059991,2.042947,2.026129,2.009529,1.993152,1.976984,1.961023,1.945268,1.929712,1.914348,1.899180,1.884197,1.869396,1.854778,1.840336,1.826064,1.811965,1.798031,1.784258,1.770648,1.757194,1.743892,1.730742,1.717741,1.704885,1.692171,1.679597,1.667161,1.654862,1.642691,1.630654,1.618744,1.606957,1.595296,1.583754,1.572334,1.561029,1.549840,1.538762,1.527797,1.516940,1.506190,1.495546,1.485006,1.474567,1.464230,1.453989,1.443847,1.433801,1.423846,1.413985,1.404214,1.394535,1.384942,1.375435,1.366014,1.356677,1.347422,1.338249,1.329156,1.320141,1.311204,1.302343,1.293557,1.284845,1.276207,1.267641,1.259145,1.250719,1.242361,1.234071,1.225848,1.217690,1.209598,1.201569,1.193604,1.185699,1.177856,1.170074,1.162351,1.154686,1.147080,1.139530,1.132035,1.124596,1.117212,1.109882,1.102605,1.095380,1.088207,1.081085,1.074012,1.066989,1.060015,1.053089,1.046212,1.039381,1.032596,1.025857,1.019163,1.012514,1.005908,0.999345,0.992827,0.986349,0.979914,0.973519,0.967166,0.960852,0.954578,0.948343,0.942147,0.935988,0.929868,0.923784,0.917737,0.911727,0.905751,0.899811,0.893907,0.888036,0.882201,0.876398,0.870628,0.864892,0.859187,0.853515,0.847874,0.842265,0.836686,0.831138,0.825620,0.820131,0.814673,0.809242,0.803841,0.798468,0.793123,0.787806,0.782516,0.777253,0.772017,0.766807,0.761623,0.756466,0.751333,0.746226,0.741144,0.736086,0.731052,0.726043,0.721057,0.716095,0.711156,0.706240,0.701346,0.696475,0.691626,0.686799,0.681994,0.677210,0.672447,0.667706,0.662984,0.658284,0.653603,0.648942,0.644302,0.639681,0.635079,0.630496,0.625932,0.621386,0.616859,0.612351,0.607860,0.603387,0.598932,0.594495,0.590074,0.585671,0.581284,0.576914,0.572561,0.568223,0.563903,0.559597,0.555308,0.551034,0.546775,0.542532,0.538304,0.534090,0.529892,0.525708,0.521538,0.517383,0.513241,0.509113,0.504999,0.500899,0.496812,0.492739,0.488678,0.484631,0.480596,0.476574,0.472564,0.468567,0.464583,0.460610,0.456649,0.452700,0.448763,0.444837,0.440922,0.437019,0.433127,0.429246,0.425376,0.421517,0.417668,0.413830,0.410003,0.406185,0.402378,0.398580,0.394793,0.391015,0.387247,0.383489,0.379740,0.376000,0.372269,0.368548,0.364835,0.361132,0.357437,0.353750,0.350073,0.346403,0.342742,0.339089,0.335445,0.331808,0.328179,0.324558,0.320945,0.317339,0.313741,0.310150,0.306566,0.302989,0.299420,0.295858,0.292302,0.288753,0.285211,0.281676,0.278147,0.274625,0.271109,0.267599,0.264095,0.260597,0.257105,0.253619,0.250139,0.246665,0.243196,0.239733,0.236275,0.232822,0.229375,0.225933,0.222496,0.219064,0.215637,0.212215,0.208797,0.205384,0.201976,0.198572,0.195173,0.191778,0.188387,0.185001,0.181618,0.178240,0.174865,0.171495,0.168128,0.164765,0.161405,0.158049,0.154696,0.151347,0.148002,0.144659,0.141320,0.137983,0.134650,0.131320,0.127992,0.124667,0.121345,0.118026,0.114709,0.111395,0.108083,0.104773,0.101466,0.098161,0.094858,0.091557,0.088258,0.084961,0.081666,0.078372,0.075081,0.071791,0.068502,0.065215,0.061929,0.058645,0.055362,0.052080,0.048799,0.045519,0.042240,0.038962,0.035685,0.032409,0.029134,0.025859,0.022584,0.019310,0.016037,0.012763,0.009491,0.006218,0.002945,-0.000327,-0.003600,-0.006872,-0.010145,-0.013418,-0.016691,-0.019965,-0.023239,-0.026513,-0.029788,-0.033064,-0.036341,-0.039618,-0.042896,-0.046175,-0.049455,-0.052736,-0.056018,-0.059301,-0.062586,-0.065872,-0.069159,-0.072448,-0.075739,-0.079031,-0.082325,-0.085620,-0.088918,-0.092217,-0.095518,-0.098822,-0.102127,-0.105435,-0.108745,-0.112058,-0.115372,-0.118690,-0.122010,-0.125332,-0.128657,-0.131985,-0.135316,-0.138650,-0.141987,-0.145327,-0.148670,-0.152017,-0.155367,-0.158720,-0.162077,-0.165437,-0.168801,-0.172168,-0.175540,-0.178915,-0.182294,-0.185677,-0.189065,-0.192456,-0.195852,-0.199253,-0.202657,-0.206066,-0.209480,-0.212899,-0.216322,-0.219750,-0.223183,-0.226621,-0.230064,-0.233512,-0.236966,-0.240425,-0.243889,-0.247359,-0.250835,-0.254316,-0.257803,-0.261296,-0.264795,-0.268300,-0.271811,-0.275328,-0.278852,-0.282382,-0.285919,-0.289463,-0.293012,-0.296569,-0.300133,-0.303704,-0.307282,-0.310867,-0.314459,-0.318059,-0.321667,-0.325281,-0.328904,-0.332535,-0.336173,-0.339819,-0.343474,-0.347136,-0.350807,-0.354487,-0.358175,-0.361871,-0.365577,-0.369291,-0.373014,-0.376747,-0.380489,-0.384240,-0.388000,-0.391770,-0.395549,-0.399339,-0.403138,-0.406948,-0.410767,-0.414597,-0.418437,-0.422288,-0.426149,-0.430022,-0.433905,-0.437799,-0.441704,-0.445621,-0.449549,-0.453489,-0.457440,-0.461403,-0.465378,-0.469366,-0.473365,-0.477377,-0.481402,-0.485439,-0.489489,-0.493552,-0.497628,-0.501718,-0.505821,-0.509938,-0.514068,-0.518212,-0.522371,-0.526543,-0.530730,-0.534932,-0.539148,-0.543380,-0.547626,-0.551887,-0.556164,-0.560457,-0.564765,-0.569089,-0.573430,-0.577787,-0.582160,-0.586550,-0.590957,-0.595381,-0.599822,-0.604280,-0.608757,-0.613251,-0.617763,-0.622294,-0.626843,-0.631410,-0.635997,-0.640603,-0.645228,-0.649873,-0.654537,-0.659222,-0.663927,-0.668652,-0.673398,-0.678165,-0.682953,-0.687763,-0.692594,-0.697447,-0.702323,-0.707221,-0.712142,-0.717085,-0.722052,-0.727043,-0.732057,-0.737095,-0.742158,-0.747245,-0.752358,-0.757495,-0.762658,-0.767847,-0.773062,-0.778303,-0.783572,-0.788868,-0.794190,-0.799540,-0.804919,-0.810326,-0.815762,-0.821226,-0.826721,-0.832245,-0.837799,-0.843384,-0.848999,-0.854647,-0.860325,-0.866036,-0.871780,-0.877556,-0.883365,-0.889207,-0.895085,-0.900997,-0.906943,-0.912925,-0.918944,-0.924998,-0.931088,-0.937217,-0.943383,-0.949586,-0.955829,-0.962111,-0.968433,-0.974795,-0.981197,-0.987642,-0.994127,-1.000654,-1.007225,-1.013840,-1.020498,-1.027201,-1.033949,-1.040743,-1.047583,-1.054471,-1.061407,-1.068390,-1.075421,-1.082504,-1.089637,-1.096821,-1.104056,-1.111343,-1.118685,-1.126079,-1.133530,-1.141034,-1.148596,-1.156215,-1.163891,-1.171625,-1.179421,-1.187275,-1.195192,-1.203170,-1.211211,-1.219317,-1.227488,-1.235724,-1.244027,-1.252398,-1.260839,-1.269348,-1.277929,-1.286582,-1.295308,-1.304109,-1.312984,-1.321936,-1.330968,-1.340077,-1.349267,-1.358537,-1.367892,-1.377329,-1.386853,-1.396463,-1.406161,-1.415949,-1.425830,-1.435802,-1.445868,-1.456030,-1.466289,-1.476647,-1.487106,-1.497667,-1.508332,-1.519104,-1.529981,-1.540967,-1.552067,-1.563282,-1.574610,-1.586053,-1.597618,-1.609306,-1.621116,-1.633050,-1.645116,-1.657311,-1.669639,-1.682100,-1.694703,-1.707443,-1.720330,-1.733361,-1.746539,-1.759872,-1.773358,-1.787000,-1.800802,-1.814770,-1.828902,-1.843209,-1.857687,-1.872344,-1.887177,-1.902197,-1.917406,-1.932804,-1.948402,-1.964200,-1.980202,-1.996410,-2.012834,-2.029472,-2.046337,-2.063426,-2.080750,-2.098310,-2.116111,-2.134166,-2.152472,-2.171034,-2.189866,-2.208968,-2.228348,-2.248014,-2.267975,-2.288230,-2.308792,-2.329666,-2.350861,-2.372384,-2.394246,-2.416451,-2.439013,-2.461932,-2.485225,-2.508907,-2.532973,-2.557447,-2.582331,-2.607637,-2.633381,-2.659575,-2.686229,-2.713351,-2.740965,-2.769071,-2.797696,-2.826855,-2.856547,-2.886811,-2.917647,-2.949078,-2.981115,-3.013791,-3.047117,-3.081114,-3.115799,-3.151204,-3.187353,-3.224257,-3.261940,-3.300450,-3.339790,-3.380000,-3.421119,-3.463167,-3.506176,-3.550178,-3.595221,-3.641329,-3.688567,-3.736949,-3.786516,-3.837343,-3.889462,-3.942923,-3.997777,-4.054081,-4.111910,-4.171307,-4.232357,-4.295127,-4.359673,-4.426091,-4.494463,-4.564876,-4.637423,-4.712202,-4.789341,-4.868928,-4.951083,-5.035957,-5.123660,-5.214362,-5.308222,-5.405376,-5.506062,-5.610413,-5.718697,-5.831074,-5.947849,-6.069287,-6.195595,-6.327152,-6.464250,-6.607333,-6.756666,-6.912809,-7.076139,-7.247270,-7.426661,-7.614986,-7.812988,-8.021369,-8.240966,-8.472709,-8.717712,-8.977063,-9.252149,-9.544444,-9.855518,-10.187346,-10.542073,-10.922157,-11.330418,-11.770106,-12.244998,-12.759497,-13.318949,-13.929322,-14.598114,-15.333896,-16.147524,-17.051752,-18.062931,-19.201229,-20.492224,-21.968847,-23.674242,-25.666035,-28.022980,-30.855625,-34.325336,-38.671257,-44.279133,-51.786640,-62.355801,-78.351486,-105.374077,-160.823425,-339.558563,3058.104004,277.777771,145.518036,98.570724,74.526756,59.912529,50.087654,43.031113,37.717346,33.570564,30.244373,27.517130,25.241053,23.312197,21.656740,20.220404,18.962379,17.851406,16.863123,15.978014,15.180957,14.459434,13.803003,13.203237,12.653263,12.146979,11.679514,11.246317,10.843987,10.469231,10.119205,9.791730,9.484517,9.195825,8.924029,8.667614,8.425310,8.196050,7.978808,7.772605,7.576619,7.390109,7.212405,7.042899,6.881034,6.726306,6.578212,6.436373,6.300403,6.169907,6.044597,5.924136,5.808280,5.696707,5.589246,5.485644,5.385696,5.289186,5.195992,5.105896,5.018745,4.934446,4.852814,4.773726,4.697063,4.622738,4.550626,4.480628,4.412654,4.346616,4.282435,4.220015,4.159301,4.100226,4.042707,3.986685,3.932116,3.878931,3.827077,3.776506,3.727171,3.679027,3.632019,3.586132,3.541290,3.497494,3.454685,3.412818,3.371897,3.331856,3.292680,3.254340,3.216810,3.180065,3.144071,3.108805,3.074265,3.040401,3.007211,2.974659,2.942743,2.911428,2.880715,2.850570,2.820978,2.791931,2.763408,2.735402,2.707891,2.680865,2.654301,2.628197,2.602540,2.577320,2.552518,2.528132,2.504138,2.480540,2.457316,2.434470,2.411981,2.389846,2.368052,2.346597,2.325462,2.304652,2.284153,2.263960,2.244059,2.224452,2.205125,2.186079,2.167303,2.148791,2.130533,2.112535,2.094780,2.077266,2.059991,2.042947,2.026129,2.009529,1.993152,1.976984,1.961023,1.945268,1.929712,1.914348,1.899180,1.884197,1.869396,1.854778,1.840336,1.826064,1.811965,1.798031,1.784258,1.770648,1.757191,1.743892,1.730742,1.717741,1.704885,1.692171,1.679597,1.667161,1.654862,1.642691,1.630654,1.618744,1.606957,1.595296,1.583757,1.572334,1.561029,1.549840,1.538762,1.527795,1.516940,1.506190,1.495546,1.485006,1.474567,1.464230,1.453989,1.443847,1.433801,1.423846,1.413985,1.404216,1.394535,1.384942,1.375435,1.366014,1.356677,1.347422,1.338249,1.329156,1.320141,1.311204,1.302343,1.293557,1.284847,1.276207,1.267641,1.259145,1.250718,1.242361,1.234071,1.225848,1.217690,1.209598,1.201569,1.193604,1.185699,1.177856,1.170074,1.162350,1.154686,1.147080,1.139530,1.132035,1.124596,1.117212,1.109882,1.102605,1.095380,1.088207,1.081083,1.074011,1.066990,1.060016,1.053089,1.046212,1.039381,1.032596,1.025857,1.019163,1.012514,1.005908,0.999345,0.992827,0.986350,0.979914,0.973519,0.967166,0.960852,0.954578,0.948343,0.942147,0.935988,0.929868,0.923783,0.917737,0.911727,0.905751,0.899811,0.893907,0.888036,0.882201,0.876398,0.870628,0.864892,0.859187,0.853515,0.847874,0.842264,0.836686,0.831138,0.825620,0.820131,0.814673,0.809242,0.803841,0.798468,0.793123,0.787806,0.782516,0.777253,0.772017,0.766808,0.761624,0.756466,0.751333,0.746226,0.741144,0.736085,0.731052,0.726042,0.721057,0.716094,0.711156,0.706240,0.701346,0.696475,0.691627,0.686799,0.681994,0.677210,0.672447,0.667705,0.662984,0.658284,0.653603,0.648943,0.644302,0.639681,0.635079,0.630496,0.625931,0.621386,0.616859,0.612350,0.607860,0.603388,0.598933,0.594495,0.590074,0.585671,0.581284,0.576914,0.572561,0.568223,0.563902,0.559597,0.555308,0.551034,0.546776,0.542532,0.538304,0.534090,0.529892,0.525708,0.521538,0.517382,0.513241,0.509113,0.505000,0.500899,0.496812,0.492739,0.488678,0.484631,0.480596,0.476574,0.472564,0.468567,0.464582,0.460609,0.456649,0.452700,0.448763,0.444837,0.440922,0.437019,0.433127,0.429246,0.425376,0.421517,0.417668,0.413831,0.410003,0.406185,0.402378,0.398580,0.394793,0.391015,0.387247,0.383489,0.379740,0.376000,0.372269,0.368548,0.364835,0.361132,0.357437,0.353750,0.350073,0.346403,0.342742,0.339089,0.335445,0.331808,0.328179,0.324558,0.320945,0.317339,0.313741,0.310150,0.306566,0.302989,0.299420,0.295857,0.292302,0.288753,0.285212,0.281676,0.278147,0.274625,0.271109,0.267599,0.264095,0.260597,0.257105,0.253619,0.250139,0.246665,0.243196,0.239733,0.236275,0.232822,0.229375,0.225933,0.222496,0.219064,0.215637,0.212214,0.208797,0.205384,0.201976,0.198572,0.195173,0.191778,0.188387,0.185001,0.181618,0.178240,0.174865,0.171494,0.168128,0.164765,0.161405,0.158049,0.154697,0.151347,0.148002,0.144659,0.141320,0.137983,0.134650,0.131319,0.127992,0.124668,0.121346,0.118026,0.114709,0.111395,0.108083,0.104773,0.101466,0.098161,0.094858,0.091557,0.088258,0.084961,0.081666,0.078373,0.075081,0.071791,0.068502,0.065215,0.061929,0.058645,0.055361,0.052079,0.048799,0.045519,0.042240,0.038962,0.035685,0.032409,0.029133,0.025858,0.022584,0.019310,0.016036,0.012763,0.009491,0.006218,0.002945,-0.000327,-0.003600,-0.006872,-0.010145,-0.013418,-0.016691,-0.019965,-0.023239,-0.026513,-0.029788,-0.033064,-0.036340,-0.039618,-0.042896,-0.046175,-0.049455,-0.052736,-0.056018,-0.059302,-0.062586,-0.065872,-0.069159,-0.072448,-0.075739,-0.079031,-0.082325,-0.085620,-0.088918,-0.092217,-0.095519,-0.098822,-0.102127,-0.105435,-0.108745,-0.112057,-0.115372,-0.118690,-0.122010,-0.125332,-0.128657,-0.131986,-0.135317,-0.138650,-0.141987,-0.145327,-0.148670,-0.152017,-0.155367,-0.158720,-0.162077,-0.165437,-0.168801,-0.172168,-0.175540,-0.178915,-0.182294,-0.185677,-0.189065,-0.192456,-0.195852,-0.199253,-0.202657,-0.206066,-0.209480,-0.212899,-0.216322,-0.219750,-0.223183,-0.226621,-0.230064,-0.233512,-0.236966,-0.240425,-0.243889,-0.247359,-0.250835,-0.254316,-0.257803,-0.261296,-0.264795,-0.268300,-0.271811,-0.275328,-0.278852,-0.282382,-0.285919,-0.289463,-0.293013,-0.296570,-0.300133,-0.303704,-0.307282,-0.310867,-0.314459,-0.318059,-0.321667,-0.325282,-0.328904,-0.332535,-0.336173,-0.339819,-0.343473,-0.347136,-0.350807,-0.354487,-0.358175,-0.361871,-0.365577,-0.369291,-0.373015,-0.376747,-0.380489,-0.384240,-0.388000,-0.391770,-0.395549,-0.399339,-0.403138,-0.406948,-0.410767,-0.414597,-0.418437,-0.422288,-0.426150,-0.430021,-0.433904,-0.437799,-0.441704,-0.445621,-0.449549,-0.453489,-0.457440,-0.461403,-0.465378,-0.469366,-0.473366,-0.477377,-0.481402,-0.485439,-0.489489,-0.493552,-0.497629,-0.501718,-0.505821,-0.509938,-0.514068,-0.518213,-0.522371,-0.526543,-0.530730,-0.534932,-0.539148,-0.543379,-0.547626,-0.551887,-0.556164,-0.560457,-0.564765,-0.569090,-0.573430,-0.577786,-0.582160,-0.586550,-0.590956,-0.595381,-0.599822,-0.604280,-0.608757,-0.613251,-0.617764,-0.622294,-0.626843,-0.631410,-0.635997,-0.640603,-0.645228,-0.649873,-0.654537,-0.659222,-0.663927,-0.668652,-0.673398,-0.678165,-0.682953,-0.687763,-0.692594,-0.697447,-0.702323,-0.707221,-0.712142,-0.717085,-0.722052,-0.727043,-0.732057,-0.737095,-0.742157,-0.747245,-0.752357,-0.757495,-0.762658,-0.767847,-0.773062,-0.778304,-0.783572,-0.788868,-0.794190,-0.799540,-0.804918,-0.810326,-0.815762,-0.821226,-0.826721,-0.832245,-0.837799,-0.843384,-0.849000,-0.854647,-0.860325,-0.866036,-0.871780,-0.877556,-0.883365,-0.889208,-0.895085,-0.900997,-0.906943,-0.912926,-0.918944,-0.924998,-0.931088,-0.937216,-0.943382,-0.949586,-0.955829,-0.962111,-0.968433,-0.974795,-0.981197,-0.987642,-0.994127,-1.000654,-1.007225,-1.013839,-1.020498,-1.027200,-1.033949,-1.040743,-1.047583,-1.054471,-1.061407,-1.068390,-1.075423,-1.082504,-1.089637,-1.096820,-1.104055,-1.111343,-1.118685,-1.126079,-1.133530,-1.141034,-1.148596,-1.156215,-1.163891,-1.171625,-1.179419,-1.187275,-1.195192,-1.203170,-1.211211,-1.219317,-1.227488,-1.235724,-1.244027,-1.252398,-1.260837,-1.269348,-1.277929,-1.286582,-1.295308,-1.304109,-1.312984,-1.321936,-1.330968,-1.340077,-1.349267,-1.358539,-1.367890,-1.377329,-1.386853,-1.396463,-1.406161,-1.415949,-1.425830,-1.435802,-1.445868,-1.456030,-1.466289,-1.476647,-1.487104,-1.497665,-1.508332,-1.519101,-1.529981,-1.540970,-1.552067,-1.563282,-1.574610,-1.586055,-1.597620,-1.609303,-1.621113,-1.633050,-1.645116,-1.657311,-1.669639,-1.682100,-1.694703,-1.707446,-1.720330,-1.733361,-1.746542,-1.759869,-1.773355,-1.787000,-1.800802,-1.814770,-1.828906,-1.843209,-1.857687,-1.872344,-1.887177,-1.902200,-1.917406,-1.932804,-1.948402,-1.964200,-1.980198,-1.996410,-2.012834,-2.029472,-2.046337,-2.063426,-2.080750,-2.098310,-2.116111,-2.134162,-2.152468,-2.171034,-2.189866,-2.208968,-2.228353,-2.248014,-2.267975,-2.288230,-2.308792,-2.329666,-2.350856,-2.372384,-2.394240,-2.416451,-2.439007,-2.461932,-2.485225,-2.508907,-2.532973,-2.557447,-2.582331,-2.607637,-2.633381,-2.659575,-2.686229,-2.713351,-2.740965,-2.769071,-2.797696,-2.826855,-2.856555,-2.886811,-2.917647,-2.949070,-2.981115,-3.013791,-3.047117,-3.081114,-3.115799,-3.151204,-3.187353,-3.224257,-3.261940,-3.300450,-3.339790,-3.380000,-3.421119,-3.463156,-3.506176,-3.550178,-3.595221,-3.641329,-3.688567,-3.736949,-3.786516,-3.837343,-3.889462,-3.942907,-3.997777,-4.054081,-4.111910,-4.171307,-4.232357,-4.295127,-4.359673,-4.426091,-4.494463,-4.564876,-4.637423,-4.712202,-4.789341,-4.868928,-4.951083,-5.035957,-5.123660,-5.214362,-5.308222,-5.405406,-5.506062,-5.610413,-5.718697,-5.831074,-5.947849,-6.069250,-6.195595,-6.327152,-6.464291,-6.607333,-6.756711,-6.912809,-7.076189,-7.247218,-7.426661,-7.614986,-7.812988,-8.021369,-8.240966,-8.472709,-8.717712,-8.977063,-9.252149,-9.544444,-9.855518,-10.187346,-10.542073,-10.922157,-11.330418,-11.770106,-12.244998,-12.759659,-13.318949,-13.929516,-14.598114,-15.333896,-16.147524,-17.051752,-18.062931,-19.201229,-20.492224,-21.968847,-23.674242,-25.666035,-28.022980,-30.855625,-34.325336,-38.672752,-44.279133,-51.786640,-62.355801,-78.345345,-105.362968,-160.823425,-339.558563,3058.104004 };          // intersections with ray


float y_step[1921] = { 0.020928,0.230400,0.439808,0.649280,0.858752,1.068224,1.277760,1.487296,1.696832,1.906432,2.116096,2.325824,2.535552,2.745344,2.955200,3.165120,3.375104,3.585152,3.795264,4.005504,4.215808,4.426176,4.636672,4.847296,5.057984,5.268800,5.479680,5.690752,5.901888,6.113152,6.324608,6.536128,6.747840,6.959680,7.171648,7.383808,7.596160,7.808576,8.021248,8.234048,8.447040,8.660224,8.873600,9.087168,9.300928,9.514880,9.729088,9.943488,10.158080,10.372928,10.587968,10.803264,11.018752,11.234560,11.450560,11.666816,11.883392,12.100160,12.317184,12.534528,12.752192,12.970048,13.188224,13.406720,13.625536,13.844608,14.064000,14.283712,14.503744,14.724096,14.944768,15.165824,15.387200,15.608896,15.830976,16.053440,16.276224,16.499392,16.722944,16.946880,17.171200,17.395905,17.620993,17.846527,18.072449,18.298817,18.525568,18.752832,18.980415,19.208511,19.437056,19.666048,19.895489,20.125376,20.355776,20.586687,20.818048,21.049856,21.282240,21.515072,21.748417,21.982336,22.216703,22.451649,22.687168,22.923201,23.159807,23.396929,23.634624,23.872959,24.111809,24.351295,24.591295,24.832001,25.073280,25.315136,25.557695,25.800833,26.044672,26.289087,26.534208,26.779968,27.026432,27.273537,27.521408,27.769920,28.019136,28.269056,28.519745,28.771135,29.023296,29.276159,29.529793,29.784191,30.039425,30.295361,30.552128,30.809729,31.068096,31.327295,31.587328,31.848255,32.109951,32.372543,32.636032,32.900352,33.165569,33.431744,33.698753,33.966721,34.235649,34.505470,34.776257,35.048065,35.320766,35.594498,35.869247,36.144958,36.421696,36.699520,36.978367,37.258240,37.539200,37.821247,38.104385,38.388607,38.673920,38.960449,39.248062,39.536831,39.826817,40.117950,40.410305,40.703808,40.998592,41.294594,41.591873,41.890369,42.190208,42.491329,42.793728,43.097473,43.402561,43.708992,44.016830,44.326015,44.636608,44.948673,45.262142,45.577087,45.893440,46.211327,46.530750,46.851646,47.174080,47.498112,47.823681,48.150848,48.479679,48.810112,49.142208,49.475967,49.811455,50.148609,50.487488,50.828159,51.170559,51.514816,51.860863,52.208767,52.558529,52.910145,53.263680,53.619137,53.976578,54.335999,54.697407,55.060799,55.426304,55.793858,56.163521,56.535358,56.909313,57.285439,57.663807,58.044353,58.427200,58.812351,59.199806,59.589630,59.981888,60.376511,60.773567,61.173058,61.575104,61.979713,62.386879,62.796608,63.209023,63.624126,64.041924,64.462402,64.885757,65.311874,65.740868,66.172737,66.607552,67.045311,67.486145,67.929985,68.376961,68.827011,69.280258,69.736771,70.196480,70.659584,71.126015,71.595840,72.069122,72.545853,73.026176,73.510147,73.997696,74.489021,74.984062,75.482880,75.985603,76.492287,77.002876,77.517502,78.036285,78.559166,79.086334,79.617729,80.153473,80.693634,81.238274,81.787453,82.341248,82.899712,83.462975,84.031036,84.603966,85.181953,85.764931,86.353027,86.946365,87.545021,88.149055,88.758591,89.373634,89.994370,90.620796,91.253059,91.891266,92.535553,93.185921,93.842499,94.505409,95.174721,95.850624,96.533180,97.222527,97.918785,98.622017,99.332352,100.049919,100.774910,101.507454,102.247551,102.995522,103.751358,104.515266,105.287361,106.067841,106.856834,107.654465,108.460991,109.276413,110.101120,110.935104,111.778557,112.631744,113.494781,114.367996,115.251389,116.145279,117.049919,117.965378,118.891968,119.829887,120.779388,121.740608,122.713982,123.699585,124.697731,125.708733,126.732803,127.770180,128.821320,129.886276,130.965500,132.059326,133.167999,134.291840,135.431290,136.586563,137.758087,138.946304,140.151489,141.374023,142.614395,143.873032,145.150269,146.446655,147.762558,149.098495,150.455048,151.832520,153.231613,154.652802,156.096573,157.563644,159.054596,160.569855,162.110336,163.676544,165.269119,166.888901,168.536575,170.212799,171.918594,173.654587,175.421631,177.220734,179.052734,180.918533,182.819199,184.755783,186.729218,188.740799,190.791489,192.882690,195.015488,197.191238,199.411331,201.677185,203.990204,206.352066,208.764282,211.228485,213.746567,216.320312,218.951492,221.642426,224.395004,227.211395,230.094086,233.045441,236.067841,239.164230,242.337280,245.589890,248.925308,252.346695,255.857468,259.461365,263.162231,266.963898,270.870972,274.887817,279.019012,283.269897,287.645569,292.152130,296.795319,301.581451,306.517700,311.611084,316.869263,322.300812,327.914429,333.719299,339.725891,345.944824,352.387573,359.067017,365.996216,373.189575,380.662964,388.433167,396.517883,404.937592,413.713348,422.868103,432.427765,442.419830,452.874054,463.824249,475.306488,487.360382,500.030853,513.365662,527.419983,542.253357,557.932251,574.532532,592.137634,610.841614,630.752258,651.990051,674.691895,699.017029,725.145447,753.285095,783.680542,816.613525,852.415405,891.481873,934.280090,981.370850,1033.439209,1091.317627,1156.034790,1228.886353,1311.507324,1406.002686,1515.141479,1642.611450,1793.451904,1974.757446,2196.781738,2475.006592,2833.857178,3314.309326,3990.858643,5014.324219,6743.506348,10292.907227,21729.765625,195626.515625,17779.244141,9312.708984,6308.537109,4769.721680,3834.343994,3205.646973,2754.010986,2413.874268,2148.487061,1935.629883,1761.113281,1615.436035,1491.984375,1386.033813,1294.110474,1213.594604,1142.487671,1079.232422,1022.591309,971.580994,925.397522,883.387207,845.009460,809.809570,777.408813,747.486633,719.766602,694.014465,670.028381,647.630493,626.668518,607.008972,588.532349,571.135315,554.726135,539.221619,524.549194,510.643707,497.445496,484.902008,472.965881,461.593140,450.744843,440.385651,430.482422,421.005768,411.928833,403.226105,394.874939,386.854706,379.145294,371.729401,364.589874,357.711731,351.080902,344.683716,338.508026,332.542847,326.776825,321.200378,315.804352,310.579590,305.518219,300.612671,295.855560,291.240204,286.760437,282.409973,278.183411,274.075531,270.081024,266.195404,262.414276,258.733063,255.148026,251.655487,248.251526,244.932922,241.696518,238.539001,235.457733,232.449600,229.512192,226.643066,223.839493,221.099457,218.420731,215.801086,213.238586,210.731522,208.277756,205.875778,203.523911,201.220352,198.963776,196.752701,194.585602,192.461182,190.378235,188.335419,186.331589,184.365631,182.436295,180.542664,178.683716,176.858368,175.065735,173.304962,171.575104,169.875320,168.204803,166.562759,164.948547,163.361221,161.800262,160.264893,158.754501,157.268417,155.806076,154.366791,152.950073,151.555389,150.182083,148.829697,147.497849,146.185852,144.893311,143.619904,142.364929,141.128128,139.909119,138.707321,137.522491,136.354233,135.202179,134.065918,132.945084,131.839417,130.748550,129.672134,128.610046,127.561729,126.526978,125.505539,124.497086,123.501503,122.518402,121.547455,120.588547,119.641411,118.705727,117.781380,116.868156,115.965698,115.073921,114.192574,113.321411,112.460350,111.609154,110.767555,109.935425,109.112640,108.298943,107.494270,106.698364,105.911102,105.132286,104.361855,103.599548,102.845314,102.099007,101.360382,100.629379,99.905853,99.189697,98.480835,97.779007,97.084160,96.396156,95.714943,95.040321,94.372353,93.710655,93.055359,92.406204,91.763199,91.126205,90.495102,89.869759,89.250175,88.636223,88.027840,87.424896,86.827332,86.235008,85.647934,85.065918,84.488960,83.917053,83.349953,82.787651,82.230141,81.677246,81.128960,80.585281,80.046013,79.511101,78.980545,78.454269,77.932220,77.414268,76.900414,76.390656,75.884735,75.382851,74.884735,74.390465,73.899902,73.413055,72.929855,72.450241,71.974205,71.501572,71.032448,70.566719,70.104317,69.645187,69.189377,68.736771,68.287292,67.840958,67.397758,66.957565,66.520386,66.086143,65.654846,65.226433,64.800835,64.378113,63.958145,63.540928,63.126335,62.714497,62.305218,61.898624,61.494530,61.092991,60.693951,60.297344,59.903233,59.511551,59.122177,58.735168,58.350464,57.968063,57.587967,57.210049,56.834370,56.460800,56.089474,55.720192,55.353024,54.987968,54.624962,54.263935,53.904961,53.547905,53.192833,52.839680,52.488384,52.139008,51.791489,51.445824,51.101952,50.759872,50.419582,50.081024,49.744190,49.409088,49.075649,48.743935,48.413822,48.085312,47.758465,47.433151,47.109505,46.787327,46.466751,46.147648,45.830078,45.513985,45.199360,44.886143,44.574402,44.264065,43.955135,43.647617,43.341438,43.036610,42.733120,42.430977,42.130112,41.830593,41.532352,41.235329,40.939522,40.644993,40.351746,40.059647,39.768703,39.478977,39.190464,38.903042,38.616768,38.331650,38.047680,37.764736,37.482944,37.202175,36.922497,36.643906,36.366272,36.089729,35.814209,35.539711,35.266174,34.993664,34.722050,34.451454,34.181759,33.913090,33.645313,33.378433,33.112511,32.847424,32.583233,32.319935,32.057537,31.795967,31.535295,31.275393,31.016384,30.758144,30.500736,30.244160,29.988289,29.733248,29.479040,29.225536,28.972799,28.720833,28.469568,28.219007,27.969215,27.720127,27.471745,27.224064,26.977089,26.730753,26.485121,26.240128,25.995840,25.752192,25.509121,25.266752,25.024960,24.783808,24.543297,24.303360,24.063999,23.825216,23.587072,23.349440,23.112448,22.875969,22.639999,22.404673,22.169792,21.935488,21.701696,21.468479,21.235712,21.003456,20.771711,20.540480,20.309696,20.079359,19.849537,19.620224,19.391296,19.162880,18.934912,18.707329,18.480192,18.253504,18.027264,17.801409,17.576000,17.350912,17.126272,16.902081,16.678207,16.454720,16.231615,16.008896,15.786560,15.564544,15.342912,15.121600,14.900608,14.680000,14.459712,14.239744,14.020096,13.800768,13.581760,13.363008,13.144576,12.926464,12.708608,12.491072,12.273792,12.056768,11.840064,11.623552,11.407360,11.191360,10.975680,10.760192,10.544896,10.329920,10.115136,9.900608,9.686208,9.472128,9.258176,9.044480,8.830912,8.617600,8.404480,8.191488,7.978688,7.766080,7.553664,7.341376,7.129280,6.917312,6.705472,6.493824,6.282304,6.070912,5.859648,5.648512,5.437504,5.226624,5.015872,4.805184,4.594624,4.384128,4.173760,3.963456,3.753280,3.543168,3.333120,3.123136,2.913216,2.703360,2.493568,2.283840,2.074176,1.864512,1.654976,1.445376,1.235840,1.026368,0.816832,0.607360,0.397952,0.188480,-0.020928,-0.230400,-0.439808,-0.649280,-0.858752,-1.068224,-1.277760,-1.487296,-1.696832,-1.906432,-2.116096,-2.325824,-2.535552,-2.745344,-2.955200,-3.165120,-3.375104,-3.585152,-3.795264,-4.005504,-4.215808,-4.426176,-4.636672,-4.847296,-5.057984,-5.268800,-5.479680,-5.690752,-5.901888,-6.113152,-6.324608,-6.536128,-6.747840,-6.959680,-7.171648,-7.383808,-7.596160,-7.808640,-8.021248,-8.234048,-8.447040,-8.660224,-8.873600,-9.087168,-9.300928,-9.514880,-9.729088,-9.943488,-10.158080,-10.372928,-10.587968,-10.803264,-11.018752,-11.234560,-11.450560,-11.666816,-11.883328,-12.100160,-12.317184,-12.534528,-12.752192,-12.970048,-13.188224,-13.406720,-13.625536,-13.844608,-14.064000,-14.283712,-14.503744,-14.724096,-14.944768,-15.165824,-15.387200,-15.608896,-15.830976,-16.053440,-16.276224,-16.499392,-16.722944,-16.946880,-17.171200,-17.395905,-17.621056,-17.846527,-18.072512,-18.298817,-18.525568,-18.752832,-18.980415,-19.208511,-19.437056,-19.666048,-19.895489,-20.125376,-20.355776,-20.586687,-20.817984,-21.049856,-21.282175,-21.515072,-21.748417,-21.982336,-22.216703,-22.451649,-22.687168,-22.923201,-23.159807,-23.396929,-23.634624,-23.872896,-24.111809,-24.351295,-24.591360,-24.832001,-25.073280,-25.315136,-25.557695,-25.800833,-26.044672,-26.289087,-26.534208,-26.779968,-27.026432,-27.273537,-27.521408,-27.769920,-28.019136,-28.269056,-28.519745,-28.771135,-29.023296,-29.276159,-29.529793,-29.784191,-30.039425,-30.295361,-30.552128,-30.809729,-31.068096,-31.327295,-31.587328,-31.848255,-32.109951,-32.372543,-32.636032,-32.900352,-33.165569,-33.431744,-33.698753,-33.966721,-34.235649,-34.505470,-34.776257,-35.048065,-35.320766,-35.594498,-35.869247,-36.144958,-36.421761,-36.699520,-36.978367,-37.258240,-37.539200,-37.821247,-38.104385,-38.388607,-38.673920,-38.960449,-39.248062,-39.536831,-39.826817,-40.117950,-40.410240,-40.703808,-40.998592,-41.294594,-41.591873,-41.890430,-42.190208,-42.491329,-42.793728,-43.097473,-43.402561,-43.708992,-44.016830,-44.326015,-44.636608,-44.948673,-45.262142,-45.577023,-45.893440,-46.211327,-46.530750,-46.851646,-47.174080,-47.498112,-47.823681,-48.150848,-48.479679,-48.810112,-49.142208,-49.475967,-49.811394,-50.148609,-50.487488,-50.828159,-51.170624,-51.514816,-51.860863,-52.208767,-52.558529,-52.910145,-53.263680,-53.619137,-53.976578,-54.335999,-54.697407,-55.060863,-55.426304,-55.793858,-56.163521,-56.535358,-56.909313,-57.285439,-57.663807,-58.044353,-58.427200,-58.812351,-59.199871,-59.589695,-59.981823,-60.376450,-60.773567,-61.173058,-61.575104,-61.979713,-62.386879,-62.796608,-63.209023,-63.624126,-64.041924,-64.462402,-64.885696,-65.311874,-65.740868,-66.172737,-66.607552,-67.045311,-67.486145,-67.929985,-68.376961,-68.827011,-69.280319,-69.736771,-70.196480,-70.659584,-71.126015,-71.595840,-72.069122,-72.545853,-73.026176,-73.510147,-73.997696,-74.489021,-74.984062,-75.482941,-75.985664,-76.492287,-77.002815,-77.517502,-78.036285,-78.559166,-79.086334,-79.617729,-80.153473,-80.693634,-81.238274,-81.787453,-82.341309,-82.899712,-83.462914,-84.030975,-84.603966,-85.181885,-85.764931,-86.353027,-86.946434,-87.545090,-88.149117,-88.758591,-89.373695,-89.994301,-90.620735,-91.253059,-91.891266,-92.535484,-93.185860,-93.842499,-94.505409,-95.174782,-95.850685,-96.533249,-97.222466,-97.918716,-98.621948,-99.332352,-100.049919,-100.774910,-101.507454,-102.247620,-102.995522,-103.751358,-104.515327,-105.287422,-106.067780,-106.856766,-107.654465,-108.460930,-109.276413,-110.101059,-110.935043,-111.778557,-112.631805,-113.494850,-114.368065,-115.251457,-116.145279,-117.049858,-117.965309,-118.891907,-119.829887,-120.779327,-121.740669,-122.713982,-123.699646,-124.697792,-125.708801,-126.732735,-127.770180,-128.821243,-129.886276,-130.965500,-132.059326,-133.167999,-134.291840,-135.431290,-136.586624,-137.758209,-138.946365,-140.151367,-141.373947,-142.614395,-143.872955,-145.150269,-146.446655,-147.762558,-149.098557,-150.455048,-151.832581,-153.231674,-154.652679,-156.096512,-157.563583,-159.054535,-160.569855,-162.110336,-163.676544,-165.269119,-166.888962,-168.536575,-170.212921,-171.918655,-173.654465,-175.421570,-177.220673,-179.052673,-180.918533,-182.819199,-184.755783,-186.729279,-188.740860,-190.791611,-192.882812,-195.015610,-197.191101,-199.411270,-201.677124,-203.990204,-206.352066,-208.764282,-211.228546,-213.746628,-216.320389,-218.951675,-221.642563,-224.394745,-227.211258,-230.093948,-233.045319,-236.067841,-239.164230,-242.337280,-245.589951,-248.925369,-252.346817,-255.857666,-259.461639,-263.161987,-266.963776,-270.870850,-274.887604,-279.018951,-283.269836,-287.645691,-292.152191,-296.795471,-301.581696,-306.517944,-311.611389,-316.868988,-322.300537,-327.914185,-333.719238,-339.725830,-345.944763,-352.387787,-359.067200,-365.996429,-373.190002,-380.663483,-388.432526,-396.517517,-404.937225,-413.712891,-422.867981,-432.427704,-442.419708,-452.874298,-463.824585,-475.306824,-487.361145,-500.031616,-513.365051,-527.419312,-542.252686,-557.932068,-574.532349,-592.137512,-610.842102,-630.752808,-651.990662,-674.693420,-699.018616,-725.143250,-753.283752,-783.679016,-816.611938,-852.415039,-891.481445,-934.279663,-981.372253,-1033.440674,-1091.319214,-1156.039185,-1228.891235,-1311.500000,-1405.998047,-1515.136108,-1642.605103,-1793.450317,-1974.755493,-2196.788330,-2475.014893,-2833.867920,-3314.344727,-3990.910156,-5014.405762,-6743.398926,-10292.657227,-21728.652344,-195645.531250,-17779.402344,-9312.751953,-6308.482422,-4769.690430,-3834.323975,-3205.613770,-2753.986572,-2413.898926,-2148.498047,-1935.638794,-1761.120605,-1615.437378,-1491.985474,-1386.034790,-1294.108154,-1213.592529,-1142.485840,-1079.228638,-1022.587891,-971.583252,-925.399536,-883.389038,-845.009827,-809.809875,-777.409058,-747.485901,-719.765869,-694.013794,-670.026917,-647.629150,-626.670227,-607.009827,-588.533203,-571.136108,-554.726318,-539.221802,-524.549316,-510.643402,-497.445129,-484.901703,-472.965179,-461.592438,-450.745728,-440.386108,-430.482880,-421.006195,-411.928894,-403.226166,-394.875061,-386.854462,-379.145081,-371.728973,-364.589447,-357.711304,-351.081146,-344.683960,-338.508362,-332.542847,-326.776886,-321.200439,-315.804169,-310.579468,-305.518066,-300.612427,-295.855225,-291.240570,-286.760651,-282.410187,-278.183624,-274.075592,-270.081085,-266.195465,-262.414154,-258.733002,-255.147903,-251.655228,-248.251328,-244.933182,-241.696640,-238.539139,-235.457733,-232.449661,-229.512253,-226.642944,-223.839417,-221.099396,-218.420547,-215.800903,-213.238785,-210.731644,-208.277893,-205.875900,-203.523911,-201.220352,-198.963776,-196.752640,-194.585541,-192.461121,-190.378113,-188.335297,-186.331711,-184.365692,-182.436356,-180.542725,-178.683716,-176.858368,-175.065735,-173.304901,-171.575043,-169.875198,-168.204666,-166.562683,-164.948608,-163.361343,-161.800323,-160.264893,-158.754501,-157.268417,-155.806015,-154.366714,-152.950012,-151.555267,-150.182022,-148.829819,-147.497925,-146.185913,-144.893372,-143.619904,-142.364929,-141.128128,-139.909058,-138.707321,-137.522491,-136.354172,-135.202042,-134.065918,-132.945145,-131.839493,-130.748611,-129.672195,-128.609985,-127.561661,-126.526909,-125.505470,-124.497086,-123.501442,-122.518272,-121.547523,-120.588608,-119.641411,-118.705795,-117.781441,-116.868156,-115.965698,-115.073921,-114.192513,-113.321411,-112.460289,-111.609154,-110.767616,-109.935486,-109.112640,-108.299011,-107.494270,-106.698364,-105.911102,-105.132286,-104.361794,-103.599487,-102.845245,-102.099007,-101.360382,-100.629379,-99.905853,-99.189697,-98.480766,-97.779007,-97.084160,-96.396156,-95.714943,-95.040321,-94.372353,-93.710716,-93.055359,-92.406204,-91.763199,-91.126144,-90.495041,-89.869759,-89.250175,-88.636223,-88.027840,-87.424896,-86.827393,-86.235069,-85.647934,-85.065987,-84.489021,-83.917053,-83.349953,-82.787651,-82.230080,-81.677246,-81.128960,-80.585213,-80.046013,-79.511169,-78.980606,-78.454269,-77.932220,-77.414268,-76.900414,-76.390594,-75.884735,-75.382782,-74.884735,-74.390465,-73.899971,-73.413055,-72.929855,-72.450241,-71.974144,-71.501572,-71.032448,-70.566719,-70.104256,-69.645187,-69.189377,-68.736771,-68.287361,-67.841026,-67.397758,-66.957565,-66.520386,-66.086143,-65.654846,-65.226433,-64.800835,-64.378113,-63.958145,-63.540928,-63.126400,-62.714497,-62.305279,-61.898624,-61.494530,-61.092991,-60.693951,-60.297344,-59.903233,-59.511490,-59.122177,-58.735168,-58.350529,-57.968128,-57.587967,-57.210049,-56.834370,-56.460800,-56.089474,-55.720192,-55.353024,-54.987968,-54.624962,-54.264000,-53.904961,-53.547905,-53.192833,-52.839680,-52.488384,-52.139008,-51.791489,-51.445824,-51.101952,-50.759937,-50.419582,-50.081024,-49.744190,-49.409088,-49.075649,-48.743935,-48.413822,-48.085312,-47.758465,-47.433151,-47.109440,-46.787392,-46.466751,-46.147648,-45.830078,-45.513985,-45.199360,-44.886143,-44.574402,-44.264065,-43.955135,-43.647617,-43.341438,-43.036671,-42.733185,-42.430977,-42.130177,-41.830593,-41.532288,-41.235329,-40.939522,-40.644993,-40.351681,-40.059586,-39.768768,-39.479038,-39.190464,-38.903042,-38.616768,-38.331650,-38.047680,-37.764736,-37.482880,-37.202175,-36.922497,-36.643841,-36.366337,-36.089790,-35.814209,-35.539711,-35.266174,-34.993599,-34.722050,-34.451454,-34.181759,-33.913090,-33.645248,-33.378433,-33.112511,-32.847424,-32.583233,-32.320000,-32.057537,-31.795967,-31.535295,-31.275393,-31.016384,-30.758144,-30.500736,-30.244160,-29.988352,-29.733313,-29.479040,-29.225536,-28.972799,-28.720768,-28.469568,-28.219007,-27.969215,-27.720127,-27.471745,-27.224129,-26.977089,-26.730816,-26.485121,-26.240192,-25.995840,-25.752192,-25.509121,-25.266752,-25.024960,-24.783808,-24.543297,-24.303360,-24.063999,-23.825216,-23.587072,-23.349440,-23.112448,-22.875969,-22.639999,-22.404608,-22.169792,-21.935488,-21.701759,-21.468479,-21.235712,-21.003456,-20.771711,-20.540480,-20.309696,-20.079359,-19.849537,-19.620224,-19.391296,-19.162880,-18.934912,-18.707329,-18.480255,-18.253504,-18.027264,-17.801409,-17.576000,-17.350912,-17.126272,-16.902081,-16.678207,-16.454720,-16.231680,-16.008896,-15.786560,-15.564544,-15.342912,-15.121600,-14.900608,-14.680000,-14.459712,-14.239744,-14.020096,-13.800768,-13.581760,-13.363008,-13.144576,-12.926464,-12.708608,-12.491072,-12.273792,-12.056768,-11.840000,-11.623552,-11.407360,-11.191360,-10.975680,-10.760192,-10.544960,-10.329920,-10.115136,-9.900544,-9.686208,-9.472064,-9.258176,-9.044416,-8.830976,-8.617600,-8.404480,-8.191488,-7.978688,-7.766080,-7.553664,-7.341376,-7.129280,-6.917312,-6.705472,-6.493824,-6.282304,-6.070912,-5.859648,-5.648512,-5.437504,-5.226624,-5.015808,-4.805184,-4.594560,-4.384128,-4.173760,-3.963456,-3.753280,-3.543168,-3.333120,-3.123136,-2.913216,-2.703360,-2.493568,-2.283840,-2.074176,-1.864512,-1.654912,-1.445376,-1.235840,-1.026368,-0.816896,-0.607424,-0.397952,-0.188480,-0.020928};                 // x and y steps, used to find intersections
float x_step[1921] = { 195718.656250,17777.777344,9313.154297,6308.526367,4769.712402,3834.401855,3205.609863,2753.991211,2413.910156,2148.516113,1935.639893,1761.096313,1615.427368,1491.980591,1386.031372,1294.105835,1213.592285,1142.489990,1079.239868,1022.592896,971.581238,925.403748,883.392212,845.007141,809.808838,777.406677,747.488892,719.764282,694.015198,670.030762,647.629150,626.670715,607.009094,588.532776,571.137878,554.727295,539.219849,524.551453,510.643707,497.446716,484.903625,472.966980,461.593933,450.745544,440.386169,430.483582,421.005554,411.927887,403.225800,394.874054,386.854218,379.144714,371.729919,364.589233,357.711731,351.081207,344.682678,338.507904,332.543488,326.777344,321.199677,315.804535,310.580109,305.518463,300.612030,295.855225,291.240051,286.760193,282.409851,278.183411,274.075836,270.080963,266.195251,262.414459,258.733246,255.147842,251.655426,248.251587,244.932922,241.696381,238.538940,235.457733,232.449982,229.512451,226.643326,223.839615,221.099838,218.420349,215.801407,213.238785,210.731522,208.277756,205.875839,203.524155,201.220551,198.963516,196.752319,194.585663,192.460922,190.378174,188.335556,186.331390,184.365753,182.436478,180.542587,178.683578,176.858109,175.065735,173.305023,171.574844,169.875259,168.204605,166.563004,164.948486,163.361145,161.800446,160.264832,158.754562,157.268219,155.806076,154.366791,152.950150,151.555328,150.182205,148.829575,147.497726,146.185791,144.893433,143.619781,142.364929,141.128006,139.909058,138.707397,137.522629,136.354111,135.202240,134.065918,132.945023,131.839417,130.748611,129.672256,128.609863,127.561729,126.526978,125.505470,124.497154,123.501572,122.518272,121.547523,120.588608,119.641342,118.705795,117.781502,116.868095,115.965759,115.073982,114.192513,113.321472,112.460419,111.609085,110.767487,109.935425,109.112640,108.298943,107.494209,106.698303,105.911171,105.132225,104.361855,103.599617,102.845245,102.098946,101.360252,100.629379,99.905853,99.189758,98.480766,97.779007,97.084160,96.396156,95.714943,95.040382,94.372292,93.710716,93.055298,92.406204,91.763268,91.126144,90.495041,89.869698,89.250237,88.636292,88.027840,87.424896,86.827332,86.235008,85.647934,85.065987,84.489021,83.917053,83.349953,82.787651,82.230080,81.677246,81.129021,80.585281,80.046013,79.511101,78.980545,78.454269,77.932159,77.414268,76.900414,76.390656,75.884735,75.382782,74.884735,74.390465,73.899902,73.413116,72.929916,72.450241,71.974144,71.501572,71.032448,70.566719,70.104317,69.645248,69.189438,68.736771,68.287292,67.840958,67.397697,66.957565,66.520386,66.086143,65.654846,65.226433,64.800896,64.378113,63.958080,63.540928,63.126335,62.714497,62.305218,61.898624,61.494530,61.092991,60.693951,60.297409,59.903233,59.511551,59.122177,58.735168,58.350529,57.968063,57.587906,57.210049,56.834305,56.460865,56.089474,55.720192,55.353088,54.987968,54.624962,54.263935,53.904961,53.547905,53.192833,52.839680,52.488384,52.139072,51.791489,51.445824,51.101952,50.759872,50.419582,50.081024,49.744190,49.409088,49.075649,48.743874,48.413822,48.085312,47.758465,47.433216,47.109505,46.787327,46.466751,46.147648,45.830078,45.513985,45.199360,44.886143,44.574402,44.264065,43.955135,43.647617,43.341438,43.036610,42.733185,42.430977,42.130177,41.830593,41.532288,41.235329,40.939583,40.645058,40.351746,40.059647,39.768703,39.478977,39.190464,38.903042,38.616768,38.331650,38.047680,37.764736,37.482944,37.202175,36.922497,36.643906,36.366272,36.089790,35.814209,35.539711,35.266174,34.993599,34.722050,34.451454,34.181759,33.913090,33.645313,33.378433,33.112511,32.847424,32.583233,32.319935,32.057537,31.795967,31.535295,31.275393,31.016384,30.758144,30.500736,30.244097,29.988289,29.733313,29.479040,29.225536,28.972799,28.720833,28.469568,28.219007,27.969215,27.720127,27.471745,27.224064,26.977089,26.730753,26.485121,26.240192,25.995840,25.752192,25.509121,25.266752,25.024960,24.783808,24.543297,24.303360,24.063999,23.825216,23.587072,23.349440,23.112448,22.875969,22.639999,22.404673,22.169792,21.935488,21.701696,21.468479,21.235712,21.003456,20.771711,20.540480,20.309696,20.079424,19.849600,19.620224,19.391296,19.162880,18.934912,18.707329,18.480192,18.253504,18.027264,17.801409,17.576000,17.350977,17.126335,16.902081,16.678207,16.454720,16.231615,16.008896,15.786560,15.564544,15.342912,15.121600,14.900608,14.680000,14.459712,14.239744,14.020096,13.800768,13.581760,13.363008,13.144576,12.926464,12.708608,12.491072,12.273792,12.056768,11.840064,11.623552,11.407360,11.191360,10.975680,10.760192,10.544960,10.329920,10.115136,9.900544,9.686208,9.472128,9.258176,9.044480,8.830912,8.617600,8.404480,8.191488,7.978688,7.766080,7.553664,7.341376,7.129280,6.917312,6.705472,6.493824,6.282304,6.070912,5.859648,5.648512,5.437504,5.226624,5.015808,4.805184,4.594624,4.384128,4.173760,3.963456,3.753280,3.543168,3.333120,3.123136,2.913216,2.703360,2.493568,2.283840,2.074176,1.864576,1.654976,1.445376,1.235840,1.026368,0.816832,0.607424,0.397952,0.188480,-0.020928,-0.230400,-0.439808,-0.649280,-0.858752,-1.068224,-1.277760,-1.487296,-1.696832,-1.906432,-2.116096,-2.325824,-2.535552,-2.745344,-2.955200,-3.165120,-3.375104,-3.585152,-3.795264,-4.005504,-4.215808,-4.426176,-4.636672,-4.847296,-5.057984,-5.268800,-5.479680,-5.690752,-5.901888,-6.113152,-6.324608,-6.536128,-6.747840,-6.959680,-7.171712,-7.383808,-7.596160,-7.808640,-8.021248,-8.234048,-8.447040,-8.660224,-8.873600,-9.087168,-9.300928,-9.514880,-9.729088,-9.943488,-10.158080,-10.372928,-10.587968,-10.803264,-11.018752,-11.234560,-11.450560,-11.666816,-11.883328,-12.100160,-12.317184,-12.534528,-12.752192,-12.970048,-13.188224,-13.406720,-13.625536,-13.844608,-14.064000,-14.283712,-14.503744,-14.724096,-14.944768,-15.165824,-15.387200,-15.608896,-15.830976,-16.053440,-16.276224,-16.499392,-16.722944,-16.946880,-17.171200,-17.395905,-17.620993,-17.846527,-18.072449,-18.298817,-18.525633,-18.752768,-18.980415,-19.208511,-19.437056,-19.666048,-19.895489,-20.125376,-20.355776,-20.586687,-20.817984,-21.049856,-21.282240,-21.515072,-21.748417,-21.982336,-22.216703,-22.451649,-22.687168,-22.923201,-23.159744,-23.396929,-23.634624,-23.872896,-24.111809,-24.351295,-24.591360,-24.832001,-25.073280,-25.315136,-25.557695,-25.800833,-26.044672,-26.289087,-26.534208,-26.779968,-27.026432,-27.273537,-27.521408,-27.769920,-28.019136,-28.269056,-28.519745,-28.771135,-29.023296,-29.276159,-29.529793,-29.784191,-30.039425,-30.295361,-30.552128,-30.809729,-31.068096,-31.327295,-31.587328,-31.848192,-32.109951,-32.372543,-32.636032,-32.900352,-33.165569,-33.431744,-33.698753,-33.966721,-34.235649,-34.505470,-34.776321,-35.048065,-35.320766,-35.594498,-35.869247,-36.144958,-36.421696,-36.699520,-36.978367,-37.258240,-37.539200,-37.821247,-38.104385,-38.388607,-38.673920,-38.960449,-39.248062,-39.536831,-39.826817,-40.117950,-40.410240,-40.703808,-40.998592,-41.294594,-41.591873,-41.890369,-42.190208,-42.491329,-42.793728,-43.097473,-43.402561,-43.708992,-44.016830,-44.326015,-44.636608,-44.948673,-45.262142,-45.577087,-45.893440,-46.211327,-46.530750,-46.851646,-47.174080,-47.498112,-47.823681,-48.150913,-48.479679,-48.810112,-49.142208,-49.475967,-49.811394,-50.148609,-50.487553,-50.828159,-51.170559,-51.514816,-51.860863,-52.208767,-52.558464,-52.910145,-53.263680,-53.619137,-53.976578,-54.335938,-54.697407,-55.060799,-55.426304,-55.793919,-56.163586,-56.535358,-56.909248,-57.285439,-57.663807,-58.044353,-58.427200,-58.812416,-59.199871,-59.589630,-59.981888,-60.376511,-60.773502,-61.173058,-61.575104,-61.979713,-62.386879,-62.796608,-63.209087,-63.624126,-64.041855,-64.462402,-64.885757,-65.311874,-65.740868,-66.172737,-66.607552,-67.045311,-67.486145,-67.930046,-68.376961,-68.826942,-69.280258,-69.736771,-70.196541,-70.659584,-71.125954,-71.595840,-72.069054,-72.545921,-73.026176,-73.510147,-73.997757,-74.489021,-74.984001,-75.482941,-75.985603,-76.492287,-77.002876,-77.517502,-78.036285,-78.559235,-79.086334,-79.617729,-80.153473,-80.693695,-81.238274,-81.787453,-82.341248,-82.899712,-83.462975,-84.030975,-84.603905,-85.181953,-85.764931,-86.353088,-86.946365,-87.545090,-88.149055,-88.758591,-89.373634,-89.994301,-90.620735,-91.253120,-91.891327,-92.535553,-93.185921,-93.842499,-94.505409,-95.174782,-95.850685,-96.533249,-97.222656,-97.918785,-98.621887,-99.332291,-100.050049,-100.775040,-101.507393,-102.247551,-102.995583,-103.751427,-104.515198,-105.287422,-106.067902,-106.856895,-107.654404,-108.460991,-109.276352,-110.101120,-110.935104,-111.778496,-112.631805,-113.494911,-114.367996,-115.251328,-116.145279,-117.049728,-117.965378,-118.891968,-119.830017,-120.779327,-121.740608,-122.713982,-123.699455,-124.697731,-125.708801,-126.732925,-127.770241,-128.821381,-129.886215,-130.965561,-132.059265,-133.167999,-134.291840,-135.431107,-136.586624,-137.758209,-138.946182,-140.151428,-141.373947,-142.614273,-143.872894,-145.150406,-146.446716,-147.762695,-149.098618,-150.455109,-151.832581,-153.231750,-154.652863,-156.096832,-157.563644,-159.054398,-160.570053,-162.110275,-163.676605,-165.269180,-166.888763,-168.536377,-170.212799,-171.918655,-173.654465,-175.421753,-177.220551,-179.052551,-180.918716,-182.819016,-184.755905,-186.729401,-188.740997,-190.791367,-192.882629,-195.015488,-197.191299,-199.411133,-201.677063,-203.990585,-206.352448,-208.764160,-211.228806,-213.746567,-216.320007,-218.951614,-221.642685,-224.395264,-227.211395,-230.094147,-233.045059,-236.068283,-239.164734,-242.337021,-245.589951,-248.925568,-252.347076,-255.857727,-259.461182,-263.162231,-266.963654,-270.870850,-274.888123,-279.019073,-283.269836,-287.645630,-292.152069,-296.795074,-301.580933,-306.517822,-311.611389,-316.869324,-322.301239,-327.914246,-333.719177,-339.726196,-345.944061,-352.387970,-359.066437,-365.996613,-373.188751,-380.662323,-388.434357,-396.518066,-404.937714,-413.712006,-422.869324,-432.426636,-442.419769,-452.872894,-463.825287,-475.306305,-487.359100,-500.031219,-513.367615,-527.421814,-542.253357,-557.933594,-574.532043,-592.137512,-610.844421,-630.753174,-651.990173,-674.692688,-699.018066,-725.146729,-753.286804,-783.679871,-816.607788,-852.412720,-891.476624,-934.279297,-981.369324,-1033.441528,-1091.312134,-1156.027588,-1228.878662,-1311.502319,-1406.006226,-1515.151489,-1642.626221,-1793.470703,-1974.760010,-2196.821533,-2474.960449,-2833.864502,-3314.344971,-3990.771240,-5014.495117,-6743.940918,-10292.699219,-21731.748047,-195718.656250,-17777.777344,-9313.154297,-6308.526367,-4769.712402,-3834.401855,-3205.609863,-2753.991211,-2413.910156,-2148.516113,-1935.639893,-1761.096313,-1615.427368,-1491.980591,-1386.031372,-1294.105835,-1213.592285,-1142.489990,-1079.239868,-1022.592896,-971.581238,-925.403748,-883.392212,-845.007141,-809.808838,-777.406677,-747.488892,-719.764282,-694.015198,-670.030762,-647.629150,-626.670715,-607.009094,-588.532776,-571.137878,-554.727295,-539.219849,-524.547180,-510.643707,-497.446716,-484.903625,-472.966980,-461.593933,-450.745544,-440.386169,-430.483582,-421.005554,-411.927887,-403.225800,-394.874054,-386.854218,-379.144714,-371.729919,-364.589233,-357.711731,-351.081207,-344.684540,-338.507904,-332.543488,-326.777344,-321.199677,-315.804535,-310.580109,-305.518463,-300.612030,-295.855225,-291.240051,-286.760193,-282.409851,-278.183411,-274.075836,-270.080963,-266.195251,-262.414459,-258.733246,-255.147842,-251.655426,-248.251587,-244.932922,-241.696381,-238.538940,-235.457733,-232.449219,-229.512451,-226.642563,-223.839615,-221.099838,-218.420349,-215.801407,-213.238785,-210.731522,-208.277756,-205.875839,-203.524155,-201.220551,-198.963516,-196.752960,-194.585663,-192.461502,-190.378174,-188.335556,-186.331390,-184.365753,-182.436478,-180.542587,-178.683578,-176.858109,-175.065735,-173.305023,-171.575363,-169.875259,-168.204605,-166.562561,-164.948486,-163.361145,-161.800446,-160.264832,-158.754562,-157.268219,-155.806076,-154.366791,-152.950150,-151.555328,-150.182205,-148.829575,-147.497726,-146.185791,-144.893433,-143.619781,-142.364929,-141.128006,-139.909058,-138.707397,-137.522629,-136.354111,-135.202240,-134.065918,-132.945023,-131.839417,-130.748611,-129.672256,-128.609863,-127.561729,-126.526978,-125.505470,-124.497154,-123.501572,-122.518272,-121.547523,-120.588608,-119.641342,-118.705795,-117.781502,-116.868095,-115.965759,-115.073982,-114.192513,-113.321472,-112.460220,-111.609085,-110.767487,-109.935425,-109.112640,-108.298943,-107.494209,-106.698303,-105.911171,-105.132225,-104.361855,-103.599617,-102.845245,-102.098946,-101.360451,-100.629379,-99.905853,-99.189758,-98.480766,-97.778877,-97.084160,-96.396156,-95.714943,-95.040382,-94.372292,-93.710716,-93.055298,-92.406204,-91.763268,-91.126144,-90.495041,-89.869827,-89.250237,-88.636292,-88.027840,-87.424896,-86.827332,-86.235008,-85.647934,-85.065987,-84.489021,-83.917053,-83.349953,-82.787651,-82.230209,-81.677246,-81.129021,-80.585281,-80.045952,-79.511101,-78.980545,-78.454269,-77.932159,-77.414268,-76.900414,-76.390656,-75.884735,-75.382782,-74.884735,-74.390404,-73.899902,-73.413116,-72.929916,-72.450241,-71.974144,-71.501572,-71.032448,-70.566719,-70.104317,-69.645248,-69.189316,-68.736702,-68.287361,-67.841026,-67.397697,-66.957565,-66.520386,-66.086143,-65.654846,-65.226433,-64.800896,-64.378113,-63.958080,-63.540928,-63.126400,-62.714497,-62.305218,-61.898624,-61.494530,-61.092991,-60.693951,-60.297409,-59.903233,-59.511551,-59.122112,-58.735168,-58.350529,-57.968063,-57.587906,-57.210049,-56.834305,-56.460865,-56.089474,-55.720192,-55.353088,-54.987968,-54.624962,-54.263935,-53.904896,-53.547905,-53.192833,-52.839680,-52.488384,-52.139072,-51.791489,-51.445824,-51.101952,-50.759872,-50.419582,-50.081024,-49.744190,-49.409088,-49.075710,-48.743935,-48.413822,-48.085312,-47.758465,-47.433216,-47.109440,-46.787327,-46.466686,-46.147648,-45.830017,-45.513985,-45.199360,-44.886143,-44.574402,-44.264130,-43.955135,-43.647617,-43.341438,-43.036610,-42.733120,-42.430977,-42.130177,-41.830593,-41.532352,-41.235329,-40.939583,-40.645058,-40.351746,-40.059586,-39.768703,-39.478977,-39.190399,-38.903042,-38.616833,-38.331711,-38.047680,-37.764736,-37.482944,-37.202175,-36.922497,-36.643906,-36.366272,-36.089729,-35.814209,-35.539711,-35.266174,-34.993664,-34.722050,-34.451454,-34.181759,-33.913090,-33.645313,-33.378433,-33.112450,-32.847424,-32.583233,-32.320000,-32.057537,-31.795967,-31.535295,-31.275393,-31.016384,-30.758144,-30.500736,-30.244097,-29.988289,-29.733248,-29.478975,-29.225536,-28.972799,-28.720833,-28.469568,-28.219007,-27.969215,-27.720127,-27.471745,-27.224064,-26.977089,-26.730753,-26.485184,-26.240192,-25.995840,-25.752192,-25.509121,-25.266752,-25.024960,-24.783808,-24.543297,-24.303360,-24.063999,-23.825216,-23.587072,-23.349440,-23.112448,-22.875969,-22.639999,-22.404673,-22.169792,-21.935488,-21.701696,-21.468479,-21.235712,-21.003456,-20.771711,-20.540480,-20.309696,-20.079424,-19.849600,-19.620224,-19.391296,-19.162880,-18.934849,-18.707329,-18.480192,-18.253569,-18.027264,-17.801409,-17.576000,-17.350977,-17.126335,-16.902081,-16.678207,-16.454720,-16.231615,-16.008896,-15.786560,-15.564544,-15.342912,-15.121600,-14.900608,-14.680000,-14.459712,-14.239744,-14.020096,-13.800768,-13.581696,-13.363008,-13.144576,-12.926464,-12.708608,-12.491072,-12.273792,-12.056768,-11.840064,-11.623552,-11.407360,-11.191360,-10.975616,-10.760192,-10.544960,-10.329920,-10.115136,-9.900608,-9.686208,-9.472128,-9.258176,-9.044480,-8.830912,-8.617600,-8.404416,-8.191488,-7.978752,-7.766144,-7.553664,-7.341376,-7.129280,-6.917312,-6.705472,-6.493824,-6.282304,-6.070912,-5.859648,-5.648512,-5.437504,-5.226624,-5.015872,-4.805184,-4.594624,-4.384128,-4.173760,-3.963456,-3.753280,-3.543104,-3.333056,-3.123136,-2.913216,-2.703360,-2.493568,-2.283840,-2.074176,-1.864512,-1.654912,-1.445376,-1.235840,-1.026304,-0.816832,-0.607424,-0.397952,-0.188480,0.020928,0.230400,0.439808,0.649280,0.858752,1.068224,1.277760,1.487296,1.696832,1.906432,2.116096,2.325760,2.535552,2.745344,2.955200,3.165120,3.375104,3.585152,3.795328,4.005504,4.215808,4.426176,4.636672,4.847296,5.057984,5.268800,5.479680,5.690752,5.901888,6.113216,6.324608,6.536128,6.747840,6.959680,7.171648,7.383808,7.596160,7.808640,8.021248,8.234048,8.447104,8.660288,8.873600,9.087168,9.300928,9.514880,9.729088,9.943488,10.158080,10.372928,10.587968,10.803264,11.018752,11.234560,11.450560,11.666816,11.883328,12.100160,12.317184,12.534528,12.752192,12.970048,13.188224,13.406720,13.625536,13.844608,14.064000,14.283712,14.503744,14.724096,14.944768,15.165824,15.387200,15.608896,15.830976,16.053440,16.276224,16.499392,16.722944,16.946880,17.171200,17.395905,17.620993,17.846527,18.072449,18.298817,18.525633,18.752832,18.980480,19.208511,19.437056,19.666048,19.895489,20.125376,20.355776,20.586687,20.818048,21.049856,21.282240,21.515072,21.748417,21.982271,22.216703,22.451649,22.687168,22.923201,23.159744,23.396929,23.634624,23.872959,24.111809,24.351295,24.591360,24.832001,25.073280,25.315136,25.557695,25.800833,26.044672,26.289087,26.534208,26.779968,27.026432,27.273600,27.521343,27.769855,28.019136,28.269056,28.519745,28.771135,29.023296,29.276159,29.529793,29.784191,30.039425,30.295424,30.552128,30.809729,31.068096,31.327295,31.587328,31.848255,32.109951,32.372543,32.636032,32.900352,33.165630,33.431744,33.698753,33.966721,34.235649,34.505470,34.776257,35.048065,35.320766,35.594498,35.869247,36.144958,36.421761,36.699520,36.978306,37.258240,37.539200,37.821182,38.104385,38.388607,38.673920,38.960449,39.248062,39.536896,39.826817,40.117950,40.410240,40.703808,40.998592,41.294594,41.591873,41.890369,42.190208,42.491329,42.793728,43.097473,43.402561,43.708992,44.016830,44.326015,44.636608,44.948673,45.262142,45.577087,45.893440,46.211327,46.530750,46.851646,47.174080,47.498047,47.823681,48.150848,48.479679,48.810112,49.142208,49.475967,49.811455,50.148609,50.487553,50.828159,51.170559,51.514751,51.860863,52.208767,52.558464,52.910145,53.263680,53.619137,53.976578,54.335999,54.697407,55.060799,55.426304,55.793919,56.163586,56.535358,56.909313,57.285439,57.663807,58.044353,58.427265,58.812416,59.199871,59.589630,59.981823,60.376450,60.773502,61.173058,61.575104,61.979713,62.386879,62.796608,63.209087,63.624126,64.041855,64.462402,64.885696,65.311874,65.740799,66.172737,66.607552,67.045311,67.486145,67.930046,68.376961,68.827072,69.280258,69.736771,70.196480,70.659523,71.125954,71.595840,72.069054,72.545921,73.026176,73.510147,73.997757,74.489021,74.984001,75.482819,75.985603,76.492287,77.002876,77.517502,78.036285,78.559235,79.086334,79.617729,80.153473,80.693565,81.238274,81.787453,82.341248,82.899712,83.462975,84.030975,84.603905,85.181953,85.764931,86.353088,86.946495,87.544960,88.149055,88.758591,89.373634,89.994301,90.620735,91.253120,91.891327,92.535553,93.185921,93.842499,94.505409,95.174660,95.850563,96.533249,97.222466,97.918785,98.622078,99.332291,100.050049,100.775040,101.507523,102.247681,102.995392,103.751228,104.515198,105.287422,106.067902,106.856895,107.654404,108.460991,109.276543,110.101120,110.935104,111.778687,112.631615,113.494720,114.367996,115.251328,116.145279,117.049988,117.965378,118.891968,119.830017,120.779327,121.740799,122.713982,123.699455,124.697731,125.708801,126.732674,127.770241,128.821381,129.886215,130.965561,132.059265,133.167999,134.291840,135.431107,136.586365,137.757950,138.946182,140.151428,141.373947,142.614594,143.872894,145.150406,146.446716,147.762695,149.098618,150.454788,151.832581,153.231354,154.652863,156.096451,157.563644,159.054398,160.570053,162.110275,163.676605,165.269180,166.888763,168.536377,170.212799,171.918655,173.654465,175.421753,177.220551,179.052551,180.918716,182.819519,184.755905,186.729401,188.740479,190.791367,192.882629,195.015488,197.191299,199.411133,201.677063,203.990585,206.352448,208.764160,211.228806,213.746567,216.320007,218.951614,221.641983,224.395264,227.211395,230.094147,233.045059,236.068283,239.164734,242.337021,245.589951,248.925568,252.346054,255.857727,259.461182,263.162231,266.963654,270.870850,274.888123,279.019073,283.269836,287.645630,292.152069,296.795074,301.580933,306.517822,311.611389,316.869324,322.301239,327.914246,333.719177,339.726196,345.945984,352.387970,359.066437,365.996613,373.188751,380.662323,388.432007,396.518066,404.937714,413.714630,422.869324,432.429504,442.419769,452.876099,463.821960,475.306305,487.359100,500.031219,513.367615,527.421814,542.253357,557.933594,574.532043,592.137512,610.844421,630.753174,651.990173,674.692688,699.018066,725.146729,753.286804,783.679871,816.618164,852.412720,891.489014,934.279297,981.369324,1033.441528,1091.312134,1156.027588,1228.878662,1311.502319,1406.006226,1515.151489,1642.626221,1793.470703,1974.760010,2196.821533,2475.056152,2833.864502,3314.344971,3990.771240,5014.102051,6743.229980,10292.699219,21731.748047,195718.656250 };                 // after initial one is found


float cos_table[1921] = { 1.154482,1.152313,1.150164,1.148036,1.145927,1.143839,1.141770,1.139721,1.137691,1.135681,1.133690,1.131718,1.129765,1.127831,1.125915,1.124018,1.122139,1.120279,1.118436,1.116612,1.114806,1.113017,1.111246,1.109492,1.107756,1.106037,1.104335,1.102650,1.100982,1.099331,1.097696,1.096078,1.094477,1.092892,1.091323,1.089770,1.088234,1.086713,1.085208,1.083719,1.082246,1.080788,1.079345,1.077918,1.076506,1.075110,1.073728,1.072362,1.071011,1.069674,1.068352,1.067045,1.065752,1.064474,1.063210,1.061961,1.060726,1.059505,1.058298,1.057106,1.055927,1.054762,1.053611,1.052474,1.051350,1.050241,1.049144,1.048062,1.046992,1.045936,1.044894,1.043864,1.042848,1.041845,1.040855,1.039878,1.038913,1.037962,1.037024,1.036098,1.035185,1.034285,1.033398,1.032523,1.031660,1.030810,1.029973,1.029147,1.028334,1.027534,1.026745,1.025969,1.025205,1.024453,1.023713,1.022985,1.022270,1.021566,1.020874,1.020193,1.019525,1.018868,1.018223,1.017590,1.016969,1.016359,1.015761,1.015174,1.014599,1.014035,1.013483,1.012942,1.012413,1.011895,1.011388,1.010893,1.010409,1.009936,1.009475,1.009025,1.008586,1.008158,1.007741,1.007335,1.006941,1.006558,1.006185,1.005824,1.005474,1.005134,1.004806,1.004489,1.004183,1.003887,1.003603,1.003329,1.003066,1.002815,1.002574,1.002344,1.002124,1.001916,1.001718,1.001531,1.001355,1.001190,1.001035,1.000892,1.000759,1.000637,1.000525,1.000424,1.000334,1.000255,1.000186,1.000129,1.000081,1.000045,1.000019,1.000004,1.000000,1.000006,1.000024,1.000051,1.000090,1.000139,1.000199,1.000270,1.000351,1.000444,1.000546,1.000660,1.000785,1.000920,1.001065,1.001222,1.001390,1.001568,1.001757,1.001957,1.002167,1.002389,1.002621,1.002864,1.003118,1.003383,1.003659,1.003945,1.004243,1.004552,1.004871,1.005201,1.005543,1.005895,1.006259,1.006633,1.007019,1.007416,1.007823,1.008242,1.008672,1.009114,1.009566,1.010030,1.010505,1.010991,1.011489,1.011997,1.012518,1.013049,1.013592,1.014147,1.014713,1.015290,1.015879,1.016480,1.017092,1.017716,1.018351,1.018999,1.019658,1.020328,1.021011,1.021705,1.022412,1.023130,1.023860,1.024603,1.025357,1.026124,1.026902,1.027693,1.028496,1.029311,1.030139,1.030979,1.031832,1.032697,1.033574,1.034464,1.035367,1.036282,1.037211,1.038152,1.039105,1.040072,1.041052,1.042044,1.043050,1.044069,1.045101,1.046146,1.047205,1.048277,1.049363,1.050462,1.051574,1.052700,1.053840,1.054994,1.056162,1.057343,1.058538,1.059748,1.060972,1.062210,1.063462,1.064728,1.066009,1.067305,1.068615,1.069940,1.071280,1.072634,1.074004,1.075388,1.076788,1.078202,1.079633,1.081078,1.082539,1.084015,1.085508,1.087016,1.088540,1.090079,1.091635,1.093207,1.094796,1.096401,1.098022,1.099660,1.101314,1.102986,1.104674,1.106379,1.108102,1.109841,1.111598,1.113373,1.115165,1.116975,1.118803,1.120649,1.122513,1.124396,1.126297,1.128216,1.130154,1.132111,1.134086,1.136081,1.138095,1.140129,1.142182,1.144255,1.146347,1.148460,1.150592,1.152745,1.154919};              // used to cacell out fishbowl effect

float inv_cos_table[1921] = { 1.000000,1.000006,1.000024,1.000051,1.000090,1.000139,1.000199,1.000270,1.000351,1.000444,1.000546,1.000660,1.000785,1.000920,1.001065,1.001222,1.001390,1.001568,1.001757,1.001957,1.002167,1.002389,1.002621,1.002864,1.003118,1.003383,1.003659,1.003945,1.004243,1.004552,1.004871,1.005201,1.005543,1.005895,1.006259,1.006633,1.007019,1.007416,1.007823,1.008242,1.008672,1.009114,1.009566,1.010030,1.010505,1.010991,1.011489,1.011997,1.012518,1.013049,1.013592,1.014147,1.014713,1.015290,1.015879,1.016480,1.017092,1.017716,1.018351,1.018999,1.019658,1.020328,1.021011,1.021705,1.022412,1.023130,1.023860,1.024603,1.025357,1.026124,1.026902,1.027693,1.028496,1.029311,1.030139,1.030979,1.031832,1.032697,1.033574,1.034464,1.035367,1.036282,1.037211,1.038152,1.039105,1.040072,1.041052,1.042044,1.043050,1.044069,1.045101,1.046146,1.047205,1.048277,1.049363,1.050462,1.051574,1.052700,1.053840,1.054994,1.056162,1.057343,1.058538,1.059748,1.060972,1.062210,1.063462,1.064728,1.066009,1.067305,1.068615,1.069940,1.071280,1.072634,1.074004,1.075388,1.076788,1.078202,1.079633,1.081078,1.082539,1.084015,1.085508,1.087016,1.088540,1.090079,1.091635,1.093207,1.094796,1.096401,1.098022,1.099660,1.101314,1.102986,1.104674,1.106379,1.108102,1.109841,1.111598,1.113373,1.115165,1.116975,1.118803,1.120649,1.122513,1.124396,1.126297,1.128216,1.130154,1.132111,1.134086,1.136081,1.138095,1.140129,1.142182,1.144255,1.146347,1.148460,1.150592,1.152745,1.154919,1.157113,1.159328,1.161564,1.163821,1.166099,1.168398,1.170720,1.173063,1.175428,1.177816,1.180225,1.182658,1.185113,1.187591,1.190092,1.192617,1.195165,1.197737,1.200333,1.202953,1.205597,1.208266,1.210960,1.213679,1.216424,1.219194,1.221989,1.224811,1.227659,1.230533,1.233434,1.236362,1.239317,1.242300,1.245311,1.248349,1.251416,1.254511,1.257636,1.260789,1.263972,1.267184,1.270427,1.273700,1.277003,1.280338,1.283703,1.287101,1.290530,1.293991,1.297485,1.301012,1.304572,1.308165,1.311793,1.315455,1.319151,1.322883,1.326650,1.330452,1.334291,1.338167,1.342079,1.346029,1.350017,1.354043,1.358108,1.362211,1.366355,1.370538,1.374762,1.379027,1.383333,1.387681,1.392071,1.396505,1.400981,1.405502,1.410067,1.414677,1.419332,1.424033,1.428781,1.433577,1.438420,1.443311,1.448251,1.453241,1.458281,1.463372,1.468514,1.473708,1.478955,1.484256,1.489610,1.495020,1.500485,1.506006,1.511585,1.517221,1.522916,1.528670,1.534484,1.540359,1.546296,1.552296,1.558359,1.564486,1.570679,1.576938,1.583264,1.589658,1.596121,1.602654,1.609258,1.615934,1.622684,1.629507,1.636406,1.643381,1.650433,1.657564,1.664775,1.672066,1.679440,1.686898,1.694440,1.702068,1.709784,1.717588,1.725483,1.733469,1.741548,1.749722,1.757991,1.766358,1.774825,1.783391,1.792061,1.800834,1.809714,1.818700,1.827797,1.837004,1.846325,1.855760,1.865313,1.874985,1.884777,1.894693,1.904735,1.914903,1.925202,1.935634,1.946199,1.956902,1.967744,1.978728,1.989858,2.001134,2.012561,2.024141,2.035877,2.047771,2.059828,2.072050,2.084440,2.097003,2.109739,2.122655,2.135753,2.149036,2.162509,2.176176,2.190039,2.204105,2.218376,2.232857,2.247553,2.262468,2.277606,2.292974,2.308575,2.324415,2.340499,2.356833,2.373421,2.390271,2.407388,2.424778,2.442447,2.460401,2.478649,2.497197,2.516051,2.535219,2.554710,2.574529,2.594687,2.615192,2.636051,2.657275,2.678872,2.700852,2.723225,2.746002,2.769192,2.792809,2.816862,2.841362,2.866325,2.891761,2.917684,2.944108,2.971047,2.998515,3.026529,3.055105,3.084258,3.114008,3.144369,3.175365,3.207012,3.239330,3.272342,3.306071,3.340536,3.375766,3.411783,3.448614,3.486287,3.524831,3.564273,3.604649,3.645990,3.688328,3.731703,3.776152,3.821711,3.868428,3.916342,3.965500,4.015953,4.067751,4.120945,4.175596,4.231761,4.289504,4.348892,4.409997,4.472889,4.537652,4.604367,4.673125,4.744020,4.817149,4.892623,4.970555,5.051061,5.134276,5.220337,5.309387,5.401589,5.497110,5.596128,5.698844,5.805466,5.916213,6.031337,6.151098,6.275776,6.405687,6.541162,6.682559,6.830284,6.984765,7.146467,7.315920,7.493687,7.680385,7.876718,8.083432,8.301389,8.531518,8.774858,9.032597,9.306036,9.596643,9.906107,10.236307,10.589384,10.967824,11.374441,11.812485,12.285772,12.798713,13.356478,13.965253,14.632338,15.366492,16.178423,17.081135,18.090704,19.227371,20.516687,21.991539,23.695196,25.685278,28.040524,30.871786,34.339279,38.684906,44.290306,51.795734,62.365185,78.355202,105.372032,160.829788,339.529053,-3056.664551,-277.802490,-145.514511,-98.575958,-74.533607,-59.919968,-50.098217,-43.043041,-37.730042,-33.585003,-30.260746,-27.535559,-25.260990,-23.333693,-21.679853,-20.245190,-18.988764,-17.879356,-16.892632,-16.009251,-15.213854,-14.493875,-13.839102,-13.241089,-12.692728,-12.188106,-11.722211,-11.290724,-10.889987,-10.516844,-10.168517,-9.842628,-9.537086,-9.250031,-8.979843,-8.725092,-8.484475,-8.256860,-8.041230,-7.836650,-7.642302,-7.457444,-7.281388,-7.113527,-6.953310,-6.800217,-6.653790,-6.513608,-6.379274,-6.250434,-6.126765,-6.007953,-5.893727,-5.783821,-5.677999,-5.576041,-5.477735,-5.382891,-5.291335,-5.202893,-5.117413,-5.034751,-4.954768,-4.877337,-4.802343,-4.729667,-4.659207,-4.590867,-4.524548,-4.460165,-4.397636,-4.336881,-4.277827,-4.220406,-4.164547,-4.110192,-4.057282,-4.005758,-3.955568,-3.906662,-3.858991,-3.812511,-3.767175,-3.722944,-3.679781,-3.637644,-3.596499,-3.556314,-3.517052,-3.478685,-3.441183,-3.404516,-3.368659,-3.333585,-3.299267,-3.265684,-3.232813,-3.200630,-3.169115,-3.138249,-3.108010,-3.078381,-3.049345,-3.020883,-2.992979,-2.965618,-2.938783,-2.912460,-2.886636,-2.861296,-2.836427,-2.812016,-2.788052,-2.764522,-2.741415,-2.718719,-2.696426,-2.674523,-2.653001,-2.631852,-2.611063,-2.590629,-2.570540,-2.550786,-2.531360,-2.512256,-2.493464,-2.474976,-2.456788,-2.438891,-2.421278,-2.403944,-2.386881,-2.370083,-2.353546,-2.337264,-2.321229,-2.305437,-2.289882,-2.274561,-2.259467,-2.244597,-2.229945,-2.215506,-2.201276,-2.187251,-2.173426,-2.159800,-2.146365,-2.133119,-2.120058,-2.107178,-2.094476,-2.081949,-2.069593,-2.057404,-2.045380,-2.033517,-2.021813,-2.010264,-1.998867,-1.987620,-1.976520,-1.965564,-1.954751,-1.944075,-1.933537,-1.923132,-1.912859,-1.902716,-1.892701,-1.882809,-1.873041,-1.863393,-1.853864,-1.844451,-1.835154,-1.825969,-1.816895,-1.807929,-1.799071,-1.790319,-1.781670,-1.773124,-1.764677,-1.756330,-1.748079,-1.739925,-1.731865,-1.723897,-1.716020,-1.708234,-1.700536,-1.692925,-1.685400,-1.677959,-1.670602,-1.663326,-1.656131,-1.649016,-1.641980,-1.635020,-1.628137,-1.621328,-1.614594,-1.607932,-1.601342,-1.594823,-1.588374,-1.581993,-1.575681,-1.569436,-1.563256,-1.557141,-1.551091,-1.545104,-1.539180,-1.533317,-1.527514,-1.521772,-1.516089,-1.510465,-1.504898,-1.499388,-1.493934,-1.488535,-1.483191,-1.477901,-1.472665,-1.467481,-1.462350,-1.457269,-1.452239,-1.447259,-1.442329,-1.437447,-1.432614,-1.427828,-1.423089,-1.418397,-1.413751,-1.409150,-1.404594,-1.400082,-1.395614,-1.391190,-1.386808,-1.382468,-1.378171,-1.373914,-1.369698,-1.365523,-1.361388,-1.357292,-1.353235,-1.349217,-1.345236,-1.341294,-1.337389,-1.333521,-1.329689,-1.325893,-1.322134,-1.318409,-1.314720,-1.311065,-1.307444,-1.303857,-1.300304,-1.296784,-1.293296,-1.289842,-1.286419,-1.283028,-1.279669,-1.276340,-1.273043,-1.269776,-1.266540,-1.263333,-1.260156,-1.257009,-1.253890,-1.250800,-1.247739,-1.244706,-1.241701,-1.238724,-1.235774,-1.232852,-1.229956,-1.227087,-1.224244,-1.221428,-1.218638,-1.215873,-1.213134,-1.210420,-1.207731,-1.205067,-1.202427,-1.199812,-1.197221,-1.194653,-1.192110,-1.189590,-1.187093,-1.184620,-1.182169,-1.179742,-1.177336,-1.174953,-1.172593,-1.170254,-1.167937,-1.165641,-1.163368,-1.161115,-1.158883,-1.156672,-1.154482,-1.152313,-1.150164,-1.148036,-1.145927,-1.143839,-1.141770,-1.139721,-1.137691,-1.135681,-1.133690,-1.131718,-1.129765,-1.127831,-1.125915,-1.124018,-1.122139,-1.120279,-1.118436,-1.116612,-1.114806,-1.113017,-1.111246,-1.109492,-1.107756,-1.106037,-1.104335,-1.102650,-1.100982,-1.099331,-1.097696,-1.096078,-1.094477,-1.092892,-1.091323,-1.089770,-1.088234,-1.086713,-1.085208,-1.083719,-1.082246,-1.080788,-1.079345,-1.077918,-1.076506,-1.075110,-1.073728,-1.072362,-1.071011,-1.069674,-1.068352,-1.067045,-1.065752,-1.064474,-1.063210,-1.061961,-1.060726,-1.059505,-1.058298,-1.057106,-1.055927,-1.054762,-1.053611,-1.052474,-1.051350,-1.050241,-1.049144,-1.048062,-1.046992,-1.045936,-1.044894,-1.043864,-1.042848,-1.041845,-1.040855,-1.039878,-1.038914,-1.037962,-1.037024,-1.036098,-1.035185,-1.034285,-1.033398,-1.032523,-1.031660,-1.030810,-1.029973,-1.029147,-1.028334,-1.027534,-1.026745,-1.025969,-1.025205,-1.024453,-1.023713,-1.022985,-1.022270,-1.021566,-1.020873,-1.020193,-1.019525,-1.018868,-1.018223,-1.017590,-1.016969,-1.016359,-1.015761,-1.015174,-1.014599,-1.014035,-1.013483,-1.012942,-1.012413,-1.011895,-1.011388,-1.010893,-1.010409,-1.009936,-1.009475,-1.009025,-1.008586,-1.008158,-1.007741,-1.007335,-1.006941,-1.006558,-1.006185,-1.005824,-1.005474,-1.005134,-1.004806,-1.004489,-1.004183,-1.003887,-1.003603,-1.003329,-1.003066,-1.002815,-1.002574,-1.002344,-1.002124,-1.001916,-1.001718,-1.001531,-1.001355,-1.001190,-1.001035,-1.000892,-1.000759,-1.000637,-1.000525,-1.000424,-1.000334,-1.000255,-1.000186,-1.000129,-1.000081,-1.000045,-1.000019,-1.000004,-1.000000,-1.000006,-1.000024,-1.000051,-1.000090,-1.000139,-1.000199,-1.000270,-1.000351,-1.000444,-1.000546,-1.000660,-1.000785,-1.000920,-1.001065,-1.001222,-1.001390,-1.001568,-1.001757,-1.001957,-1.002167,-1.002389,-1.002621,-1.002864,-1.003118,-1.003383,-1.003659,-1.003945,-1.004243,-1.004552,-1.004871,-1.005201,-1.005543,-1.005895,-1.006259,-1.006633,-1.007019,-1.007416,-1.007823,-1.008242,-1.008672,-1.009114,-1.009566,-1.010030,-1.010505,-1.010991,-1.011489,-1.011997,-1.012518,-1.013049,-1.013592,-1.014147,-1.014713,-1.015290,-1.015879,-1.016480,-1.017092,-1.017716,-1.018351,-1.018999,-1.019658,-1.020328,-1.021011,-1.021705,-1.022412,-1.023130,-1.023860,-1.024603,-1.025357,-1.026124,-1.026902,-1.027693,-1.028496,-1.029311,-1.030139,-1.030979,-1.031832,-1.032697,-1.033574,-1.034464,-1.035367,-1.036282,-1.037211,-1.038152,-1.039105,-1.040072,-1.041052,-1.042044,-1.043050,-1.044069,-1.045101,-1.046146,-1.047205,-1.048277,-1.049363,-1.050462,-1.051574,-1.052700,-1.053840,-1.054994,-1.056162,-1.057343,-1.058538,-1.059748,-1.060972,-1.062210,-1.063462,-1.064728,-1.066009,-1.067305,-1.068615,-1.069940,-1.071280,-1.072634,-1.074003,-1.075388,-1.076788,-1.078202,-1.079633,-1.081078,-1.082539,-1.084015,-1.085508,-1.087016,-1.088540,-1.090079,-1.091635,-1.093207,-1.094796,-1.096401,-1.098022,-1.099660,-1.101314,-1.102986,-1.104674,-1.106379,-1.108102,-1.109841,-1.111598,-1.113373,-1.115165,-1.116975,-1.118804,-1.120649,-1.122513,-1.124396,-1.126297,-1.128216,-1.130154,-1.132111,-1.134086,-1.136081,-1.138095,-1.140129,-1.142182,-1.144255,-1.146347,-1.148460,-1.150592,-1.152745,-1.154919,-1.157113,-1.159328,-1.161564,-1.163821,-1.166099,-1.168398,-1.170720,-1.173063,-1.175428,-1.177816,-1.180225,-1.182658,-1.185113,-1.187591,-1.190092,-1.192617,-1.195165,-1.197737,-1.200333,-1.202953,-1.205597,-1.208266,-1.210960,-1.213679,-1.216424,-1.219194,-1.221989,-1.224811,-1.227659,-1.230533,-1.233434,-1.236362,-1.239317,-1.242300,-1.245310,-1.248349,-1.251416,-1.254511,-1.257636,-1.260789,-1.263972,-1.267184,-1.270427,-1.273700,-1.277003,-1.280338,-1.283703,-1.287101,-1.290530,-1.293991,-1.297485,-1.301012,-1.304572,-1.308165,-1.311793,-1.315455,-1.319151,-1.322883,-1.326650,-1.330452,-1.334291,-1.338167,-1.342080,-1.346029,-1.350017,-1.354043,-1.358108,-1.362212,-1.366355,-1.370538,-1.374762,-1.379027,-1.383333,-1.387681,-1.392071,-1.396504,-1.400981,-1.405502,-1.410067,-1.414677,-1.419332,-1.424033,-1.428781,-1.433577,-1.438420,-1.443311,-1.448251,-1.453241,-1.458281,-1.463372,-1.468514,-1.473708,-1.478955,-1.484256,-1.489610,-1.495020,-1.500485,-1.506007,-1.511585,-1.517221,-1.522916,-1.528670,-1.534484,-1.540359,-1.546296,-1.552296,-1.558359,-1.564486,-1.570679,-1.576938,-1.583264,-1.589658,-1.596121,-1.602654,-1.609259,-1.615935,-1.622684,-1.629507,-1.636405,-1.643380,-1.650432,-1.657564,-1.664774,-1.672066,-1.679440,-1.686898,-1.694440,-1.702069,-1.709784,-1.717589,-1.725482,-1.733469,-1.741548,-1.749721,-1.757991,-1.766358,-1.774825,-1.783392,-1.792061,-1.800835,-1.809714,-1.818700,-1.827796,-1.837004,-1.846324,-1.855760,-1.865313,-1.874985,-1.884777,-1.894693,-1.904735,-1.914904,-1.925203,-1.935633,-1.946198,-1.956901,-1.967744,-1.978728,-1.989858,-2.001134,-2.012561,-2.024141,-2.035877,-2.047772,-2.059829,-2.072049,-2.084440,-2.097002,-2.109739,-2.122655,-2.135752,-2.149036,-2.162509,-2.176176,-2.190040,-2.204106,-2.218375,-2.232857,-2.247552,-2.262467,-2.277606,-2.292974,-2.308575,-2.324415,-2.340500,-2.356833,-2.373422,-2.390272,-2.407387,-2.424777,-2.442446,-2.460401,-2.478649,-2.497197,-2.516051,-2.535220,-2.554710,-2.574531,-2.594689,-2.615191,-2.636050,-2.657274,-2.678871,-2.700852,-2.723225,-2.746002,-2.769193,-2.792809,-2.816862,-2.841364,-2.866327,-2.891759,-2.917682,-2.944106,-2.971045,-2.998515,-3.026529,-3.055105,-3.084259,-3.114008,-3.144371,-3.175367,-3.207014,-3.239328,-3.272341,-3.306069,-3.340536,-3.375765,-3.411783,-3.448615,-3.486288,-3.524832,-3.564276,-3.604652,-3.645986,-3.688326,-3.731701,-3.776150,-3.821711,-3.868427,-3.916342,-3.965502,-4.015954,-4.067752,-4.120948,-4.175599,-4.231757,-4.289501,-4.348889,-4.409994,-4.472888,-4.537652,-4.604369,-4.673127,-4.744022,-4.817153,-4.892628,-4.970560,-5.051057,-5.134273,-5.220333,-5.309386,-5.401588,-5.497109,-5.596131,-5.698847,-5.805469,-5.916220,-6.031345,-6.151088,-6.275770,-6.405681,-6.541156,-6.682558,-6.830283,-6.984763,-7.146472,-7.315925,-7.493692,-7.680397,-7.876730,-8.083423,-8.301378,-8.531507,-8.774856,-9.032594,-9.306034,-9.596652,-9.906116,-10.236317,-10.589407,-10.967849,-11.374407,-11.812464,-12.285749,-12.798688,-13.356472,-13.965247,-14.632330,-15.366513,-16.178446,-17.081160,-18.090771,-19.227448,-20.516573,-21.991467,-23.695112,-25.685179,-28.040499,-30.871756,-34.339382,-38.685036,-44.290478,-51.796291,-62.365986,-78.356468,-105.370354,-160.825882,-339.511658,3056.961426,277.804962,145.515182,98.575111,74.533127,59.919655,50.097698,43.042660,37.730427,33.585171,30.260883,27.535673,25.261009,23.333710,21.679869,20.245153,18.988733,17.879328,16.892572,16.009199,15.213888,14.493906,13.839130,13.241094,12.692733,12.188110,11.722199,11.290713,10.889977,10.516821,10.168496,9.842653,9.537101,9.250044,8.979856,8.725094,8.484478,8.256863,8.041224,7.836645,7.642296,7.457432,7.281377,7.113541,6.953317,6.800223,6.653796,6.513609,6.379275,6.250436,6.126761,6.007950,5.893720,5.783814,5.677992,5.576046,5.477739,5.382895,5.291336,5.202894,5.117413,5.034750,4.954766,4.877336,4.802338,4.729663,4.659213,4.590870,4.524551,4.460167,4.397637,4.336882,4.277827,4.220404,4.164546,4.110191,4.057279,4.005755,3.955572,3.906665,3.858993,3.812511,3.767176,3.722945,3.679780,3.637643,3.596498,3.556311,3.517049,3.478688,3.441185,3.404518,3.368660,3.333585,3.299268,3.265684,3.232812,3.200629,3.169114,3.138247,3.108008,3.078383,3.049346,3.020884,2.992980,2.965618,2.938783,2.912460,2.886635,2.861295,2.836426,2.812015,2.788050,2.764523,2.741416,2.718720,2.696426,2.674523,2.653001,2.631851,2.611063,2.590628,2.570538,2.550785,2.531362,2.512257,2.493464,2.474977,2.456788,2.438891,2.421278,2.403943,2.386880,2.370083,2.353545,2.337262,2.321229,2.305437,2.289883,2.274562,2.259468,2.244597,2.229944,2.215505,2.201275,2.187250,2.173426,2.159798,2.146365,2.133119,2.120058,2.107178,2.094477,2.081949,2.069593,2.057404,2.045380,2.033517,2.021812,2.010265,1.998868,1.987621,1.976521,1.965565,1.954751,1.944075,1.933537,1.923132,1.912859,1.902716,1.892700,1.882810,1.873041,1.863393,1.853864,1.844452,1.835154,1.825969,1.816895,1.807929,1.799071,1.790318,1.781671,1.773124,1.764678,1.756330,1.748080,1.739925,1.731864,1.723897,1.716020,1.708234,1.700535,1.692924,1.685400,1.677959,1.670602,1.663326,1.656132,1.649016,1.641979,1.635020,1.628136,1.621328,1.614593,1.607932,1.601343,1.594823,1.588374,1.581994,1.575681,1.569435,1.563256,1.557141,1.551091,1.545104,1.539179,1.533317,1.527515,1.521773,1.516089,1.510465,1.504898,1.499388,1.493934,1.488535,1.483191,1.477901,1.472665,1.467482,1.462350,1.457269,1.452239,1.447259,1.442329,1.437447,1.432614,1.427828,1.423089,1.418397,1.413751,1.409150,1.404594,1.400083,1.395615,1.391190,1.386808,1.382468,1.378170,1.373914,1.369698,1.365523,1.361388,1.357292,1.353235,1.349217,1.345237,1.341294,1.337389,1.333521,1.329689,1.325893,1.322133,1.318409,1.314720,1.311065,1.307444,1.303857,1.300304,1.296784,1.293296,1.289841,1.286419,1.283028,1.279668,1.276340,1.273043,1.269776,1.266540,1.263333,1.260156,1.257009,1.253890,1.250800,1.247739,1.244706,1.241701,1.238724,1.235774,1.232852,1.229956,1.227087,1.224244,1.221428,1.218638,1.215873,1.213134,1.210420,1.207731,1.205067,1.202427,1.199812,1.197221,1.194654,1.192110,1.189590,1.187093,1.184620,1.182169,1.179742,1.177337,1.174954,1.172593,1.170254,1.167937,1.165641,1.163367,1.161115,1.158883,1.156672,1.154482,1.152313,1.150164,1.148036,1.145927,1.143839,1.141770,1.139721,1.137691,1.135681,1.133690,1.131718,1.129765,1.127831,1.125915,1.124018,1.122139,1.120279,1.118436,1.116612,1.114806,1.113017,1.111246,1.109492,1.107756,1.106037,1.104335,1.102650,1.100982,1.099331,1.097696,1.096078,1.094477,1.092892,1.091323,1.089770,1.088233,1.086713,1.085208,1.083719,1.082246,1.080788,1.079345,1.077918,1.076506,1.075110,1.073728,1.072362,1.071011,1.069674,1.068352,1.067045,1.065752,1.064474,1.063210,1.061961,1.060726,1.059505,1.058298,1.057106,1.055927,1.054762,1.053611,1.052474,1.051350,1.050241,1.049144,1.048062,1.046992,1.045936,1.044894,1.043864,1.042848,1.041845,1.040855,1.039878,1.038914,1.037962,1.037024,1.036098,1.035185,1.034285,1.033398,1.032523,1.031660,1.030810,1.029973,1.029147,1.028334,1.027534,1.026745,1.025969,1.025205,1.024453,1.023713,1.022985,1.022270,1.021566,1.020874,1.020193,1.019525,1.018868,1.018223,1.017590,1.016969,1.016359,1.015761,1.015174,1.014599,1.014035,1.013483,1.012942,1.012413,1.011895,1.011388,1.010893,1.010409,1.009936,1.009475,1.009025,1.008586,1.008158,1.007741,1.007335,1.006941,1.006558,1.006185,1.005824,1.005474,1.005135,1.004806,1.004489,1.004183,1.003887,1.003603,1.003329,1.003066,1.002815,1.002574,1.002344,1.002124,1.001916,1.001718,1.001531,1.001355,1.001190,1.001035,1.000892,1.000759,1.000636,1.000525,1.000424,1.000334,1.000255,1.000186,1.000129,1.000081,1.000045,1.000019,1.000004,1.000000};          // used to compute distances by calculating
float inv_sin_table[1921] = { 3056.234863,277.802124,145.515274,98.575554,74.533607,59.920113,50.098122,43.043045,37.730103,33.584961,30.260752,27.535595,25.260969,23.333698,21.679878,20.245178,18.988770,17.879374,16.892624,16.009256,15.213840,14.493871,13.839106,13.241079,12.692725,12.188110,11.722204,11.290723,10.889991,10.516839,10.168516,9.842630,9.537083,9.250031,8.979846,8.725089,8.484475,8.256864,8.041227,7.836650,7.642304,7.457442,7.281388,7.113529,6.953309,6.800217,6.653792,6.513608,6.379275,6.250437,6.126764,6.007954,5.893725,5.783821,5.677999,5.576039,5.477734,5.382892,5.291334,5.202893,5.117413,5.034750,4.954768,4.877338,4.802342,4.729667,4.659208,4.590867,4.524548,4.460166,4.397636,4.336881,4.277827,4.220405,4.164548,4.110193,4.057282,4.005758,3.955568,3.906662,3.858991,3.812510,3.767175,3.722945,3.679780,3.637644,3.596499,3.556313,3.517052,3.478685,3.441183,3.404516,3.368659,3.333584,3.299268,3.265685,3.232813,3.200630,3.169115,3.138248,3.108010,3.078381,3.049345,3.020883,2.992979,2.965617,2.938783,2.912460,2.886636,2.861296,2.836427,2.812016,2.788052,2.764522,2.741415,2.718719,2.696426,2.674523,2.653001,2.631851,2.611063,2.590629,2.570539,2.550786,2.531361,2.512256,2.493464,2.474977,2.456788,2.438891,2.421278,2.403944,2.386881,2.370084,2.353546,2.337263,2.321228,2.305437,2.289883,2.274561,2.259468,2.244597,2.229944,2.215506,2.201276,2.187251,2.173427,2.159800,2.146365,2.133119,2.120058,2.107178,2.094476,2.081949,2.069593,2.057404,2.045380,2.033517,2.021813,2.010264,1.998867,1.987620,1.976520,1.965565,1.954750,1.944075,1.933537,1.923132,1.912860,1.902716,1.892700,1.882809,1.873041,1.863393,1.853864,1.844452,1.835154,1.825969,1.816895,1.807930,1.799072,1.790319,1.781670,1.773124,1.764677,1.756330,1.748080,1.739925,1.731865,1.723897,1.716020,1.708234,1.700536,1.692925,1.685400,1.677959,1.670602,1.663326,1.656132,1.649016,1.641980,1.635020,1.628137,1.621328,1.614594,1.607932,1.601342,1.594823,1.588374,1.581994,1.575681,1.569435,1.563256,1.557141,1.551091,1.545104,1.539179,1.533316,1.527514,1.521772,1.516089,1.510465,1.504898,1.499388,1.493934,1.488535,1.483191,1.477902,1.472665,1.467481,1.462349,1.457269,1.452239,1.447259,1.442329,1.437447,1.432614,1.427828,1.423089,1.418397,1.413751,1.409150,1.404594,1.400082,1.395615,1.391190,1.386808,1.382468,1.378171,1.373914,1.369699,1.365523,1.361388,1.357292,1.353235,1.349217,1.345237,1.341294,1.337389,1.333521,1.329689,1.325894,1.322134,1.318409,1.314720,1.311065,1.307444,1.303857,1.300304,1.296784,1.293296,1.289842,1.286419,1.283028,1.279668,1.276340,1.273043,1.269776,1.266540,1.263333,1.260156,1.257009,1.253890,1.250800,1.247739,1.244706,1.241701,1.238724,1.235774,1.232852,1.229956,1.227087,1.224244,1.221428,1.218638,1.215873,1.213134,1.210420,1.207731,1.205067,1.202427,1.199812,1.197221,1.194654,1.192110,1.189590,1.187094,1.184620,1.182169,1.179742,1.177336,1.174953,1.172593,1.170254,1.167937,1.165641,1.163367,1.161115,1.158883,1.156672,1.154482,1.152313,1.150164,1.148036,1.145927,1.143839,1.141770,1.139721,1.137691,1.135681,1.133690,1.131718,1.129765,1.127831,1.125915,1.124018,1.122139,1.120279,1.118436,1.116612,1.114806,1.113017,1.111246,1.109492,1.107756,1.106037,1.104335,1.102650,1.100982,1.099331,1.097696,1.096078,1.094477,1.092892,1.091323,1.089770,1.088234,1.086713,1.085208,1.083719,1.082246,1.080788,1.079345,1.077918,1.076506,1.075110,1.073728,1.072362,1.071011,1.069674,1.068352,1.067045,1.065752,1.064474,1.063210,1.061961,1.060726,1.059505,1.058298,1.057106,1.055927,1.054762,1.053611,1.052474,1.051350,1.050241,1.049144,1.048062,1.046992,1.045936,1.044894,1.043864,1.042848,1.041845,1.040855,1.039878,1.038914,1.037962,1.037024,1.036098,1.035185,1.034285,1.033398,1.032523,1.031660,1.030810,1.029973,1.029147,1.028334,1.027534,1.026745,1.025969,1.025205,1.024453,1.023713,1.022985,1.022270,1.021566,1.020874,1.020193,1.019525,1.018868,1.018223,1.017590,1.016969,1.016359,1.015761,1.015174,1.014599,1.014035,1.013483,1.012942,1.012413,1.011895,1.011388,1.010893,1.010409,1.009936,1.009475,1.009025,1.008586,1.008158,1.007741,1.007335,1.006941,1.006558,1.006185,1.005824,1.005474,1.005134,1.004806,1.004489,1.004183,1.003887,1.003603,1.003329,1.003066,1.002815,1.002574,1.002344,1.002124,1.001916,1.001718,1.001531,1.001355,1.001190,1.001035,1.000892,1.000759,1.000637,1.000525,1.000424,1.000334,1.000255,1.000186,1.000129,1.000081,1.000045,1.000019,1.000004,1.000000,1.000006,1.000024,1.000051,1.000090,1.000139,1.000199,1.000270,1.000351,1.000444,1.000546,1.000660,1.000785,1.000920,1.001065,1.001222,1.001390,1.001568,1.001757,1.001957,1.002167,1.002389,1.002621,1.002864,1.003118,1.003383,1.003659,1.003945,1.004243,1.004552,1.004871,1.005201,1.005543,1.005895,1.006259,1.006633,1.007019,1.007416,1.007823,1.008242,1.008672,1.009114,1.009566,1.010030,1.010505,1.010991,1.011489,1.011997,1.012518,1.013049,1.013592,1.014147,1.014713,1.015290,1.015879,1.016480,1.017092,1.017716,1.018351,1.018999,1.019658,1.020328,1.021011,1.021705,1.022412,1.023130,1.023860,1.024603,1.025357,1.026124,1.026902,1.027693,1.028496,1.029311,1.030139,1.030979,1.031832,1.032697,1.033574,1.034464,1.035367,1.036282,1.037211,1.038152,1.039105,1.040072,1.041052,1.042044,1.043050,1.044069,1.045101,1.046146,1.047205,1.048277,1.049363,1.050462,1.051574,1.052700,1.053840,1.054994,1.056162,1.057343,1.058538,1.059748,1.060972,1.062210,1.063462,1.064728,1.066009,1.067305,1.068615,1.069940,1.071280,1.072634,1.074004,1.075388,1.076788,1.078202,1.079633,1.081078,1.082539,1.084016,1.085508,1.087016,1.088540,1.090079,1.091635,1.093207,1.094796,1.096401,1.098022,1.099660,1.101314,1.102986,1.104674,1.106379,1.108101,1.109841,1.111598,1.113373,1.115165,1.116975,1.118803,1.120649,1.122513,1.124396,1.126297,1.128216,1.130154,1.132111,1.134086,1.136081,1.138095,1.140129,1.142182,1.144255,1.146347,1.148460,1.150592,1.152745,1.154919,1.157113,1.159328,1.161564,1.163820,1.166099,1.168398,1.170720,1.173063,1.175428,1.177816,1.180225,1.182658,1.185113,1.187591,1.190092,1.192617,1.195165,1.197737,1.200333,1.202953,1.205597,1.208266,1.210960,1.213679,1.216424,1.219194,1.221989,1.224811,1.227659,1.230533,1.233434,1.236362,1.239317,1.242300,1.245311,1.248349,1.251416,1.254511,1.257635,1.260789,1.263972,1.267184,1.270427,1.273700,1.277003,1.280338,1.283703,1.287101,1.290530,1.293991,1.297485,1.301012,1.304572,1.308165,1.311793,1.315455,1.319151,1.322883,1.326650,1.330452,1.334291,1.338167,1.342079,1.346029,1.350017,1.354043,1.358108,1.362211,1.366355,1.370538,1.374762,1.379027,1.383333,1.387681,1.392071,1.396505,1.400981,1.405502,1.410067,1.414676,1.419332,1.424033,1.428781,1.433577,1.438419,1.443311,1.448251,1.453241,1.458281,1.463372,1.468514,1.473708,1.478955,1.484256,1.489610,1.495020,1.500485,1.506006,1.511585,1.517221,1.522916,1.528670,1.534484,1.540359,1.546296,1.552296,1.558359,1.564487,1.570679,1.576938,1.583264,1.589658,1.596121,1.602654,1.609258,1.615934,1.622684,1.629507,1.636406,1.643380,1.650433,1.657564,1.664775,1.672066,1.679440,1.686898,1.694440,1.702068,1.709784,1.717588,1.725483,1.733469,1.741548,1.749722,1.757991,1.766358,1.774825,1.783391,1.792061,1.800834,1.809714,1.818701,1.827797,1.837004,1.846325,1.855760,1.865313,1.874985,1.884777,1.894693,1.904734,1.914903,1.925202,1.935634,1.946199,1.956902,1.967744,1.978729,1.989858,2.001135,2.012561,2.024141,2.035877,2.047772,2.059829,2.072051,2.084440,2.097002,2.109739,2.122655,2.135753,2.149036,2.162509,2.176175,2.190039,2.204105,2.218376,2.232857,2.247553,2.262468,2.277607,2.292974,2.308576,2.324415,2.340499,2.356833,2.373422,2.390271,2.407388,2.424777,2.442446,2.460402,2.478649,2.497197,2.516052,2.535219,2.554709,2.574529,2.594688,2.615192,2.636052,2.657274,2.678872,2.700852,2.723226,2.746003,2.769192,2.792808,2.816861,2.841363,2.866325,2.891762,2.917683,2.944107,2.971046,2.998515,3.026530,3.055106,3.084258,3.114007,3.144370,3.175365,3.207012,3.239331,3.272341,3.306070,3.340537,3.375766,3.411784,3.448616,3.486286,3.524830,3.564274,3.604650,3.645990,3.688327,3.731702,3.776150,3.821712,3.868428,3.916343,3.965499,4.015952,4.067750,4.120945,4.175597,4.231762,4.289502,4.348891,4.409995,4.472890,4.537653,4.604370,4.673124,4.744019,4.817150,4.892624,4.970556,5.051065,5.134274,5.220335,5.309388,5.401590,5.497112,5.596126,5.698842,5.805463,5.916214,6.031339,6.151100,6.275773,6.405684,6.541159,6.682561,6.830286,6.984767,7.146463,7.315917,7.493683,7.680387,7.876720,8.083443,8.301383,8.531512,8.774861,9.032600,9.306040,9.596659,9.906099,10.236300,10.589389,10.967829,11.374447,11.812474,12.285761,12.798700,13.356486,13.965261,14.632346,15.366475,16.178404,17.081114,18.090717,19.227386,20.516705,21.991503,23.695154,25.685228,28.040558,30.871828,34.339470,38.684792,44.290157,51.795853,62.365353,78.355469,105.373840,160.827835,339.520355,-3056.256104,-277.799133,-145.513580,-98.576698,-74.534027,-59.920242,-50.098106,-43.042961,-37.729980,-33.585087,-30.260815,-27.535616,-25.260962,-23.333670,-21.679832,-20.245220,-18.988792,-17.879381,-16.892618,-16.009241,-15.213816,-14.493890,-13.839116,-13.241081,-12.692721,-12.188100,-11.722189,-11.290733,-10.889997,-10.516839,-10.168513,-9.842623,-9.537093,-9.250037,-8.979849,-8.725088,-8.484472,-8.256857,-8.041235,-7.836655,-7.642306,-7.457441,-7.281385,-7.113525,-6.953313,-6.800220,-6.653792,-6.513607,-6.379272,-6.250433,-6.126768,-6.007956,-5.893726,-5.783820,-5.677997,-5.576036,-5.477736,-5.382893,-5.291334,-5.202891,-5.117411,-5.034748,-4.954770,-4.877339,-4.802342,-4.729666,-4.659206,-4.590868,-4.524549,-4.460166,-4.397636,-4.336880,-4.277826,-4.220407,-4.164549,-4.110194,-4.057282,-4.005757,-3.955567,-3.906664,-3.858992,-3.812510,-3.767175,-3.722944,-3.679779,-3.637645,-3.596500,-3.556313,-3.517051,-3.478684,-3.441181,-3.404517,-3.368659,-3.333584,-3.299267,-3.265684,-3.232814,-3.200631,-3.169116,-3.138248,-3.108010,-3.078381,-3.049346,-3.020883,-2.992979,-2.965617,-2.938782,-2.912460,-2.886637,-2.861296,-2.836427,-2.812016,-2.788051,-2.764521,-2.741415,-2.718720,-2.696426,-2.674523,-2.653001,-2.631850,-2.611064,-2.590629,-2.570539,-2.550786,-2.531360,-2.512256,-2.493464,-2.474977,-2.456788,-2.438890,-2.421278,-2.403944,-2.386881,-2.370084,-2.353546,-2.337263,-2.321228,-2.305437,-2.289883,-2.274561,-2.259468,-2.244597,-2.229944,-2.215506,-2.201276,-2.187251,-2.173427,-2.159799,-2.146364,-2.133119,-2.120058,-2.107178,-2.094476,-2.081949,-2.069593,-2.057405,-2.045380,-2.033517,-2.021813,-2.010263,-1.998868,-1.987621,-1.976520,-1.965565,-1.954750,-1.944075,-1.933537,-1.923132,-1.912860,-1.902716,-1.892700,-1.882809,-1.873041,-1.863393,-1.853864,-1.844452,-1.835154,-1.825969,-1.816895,-1.807930,-1.799072,-1.790319,-1.781670,-1.773124,-1.764677,-1.756330,-1.748079,-1.739925,-1.731864,-1.723897,-1.716021,-1.708234,-1.700536,-1.692925,-1.685400,-1.677959,-1.670602,-1.663326,-1.656131,-1.649016,-1.641979,-1.635020,-1.628137,-1.621328,-1.614594,-1.607932,-1.601342,-1.594823,-1.588374,-1.581994,-1.575681,-1.569435,-1.563256,-1.557142,-1.551091,-1.545104,-1.539179,-1.533316,-1.527515,-1.521772,-1.516089,-1.510465,-1.504898,-1.499388,-1.493934,-1.488535,-1.483191,-1.477902,-1.472665,-1.467481,-1.462350,-1.457269,-1.452239,-1.447259,-1.442329,-1.437447,-1.432614,-1.427828,-1.423090,-1.418397,-1.413751,-1.409150,-1.404594,-1.400082,-1.395615,-1.391190,-1.386808,-1.382469,-1.378171,-1.373914,-1.369698,-1.365523,-1.361388,-1.357292,-1.353235,-1.349217,-1.345236,-1.341294,-1.337389,-1.333521,-1.329689,-1.325894,-1.322134,-1.318409,-1.314720,-1.311065,-1.307444,-1.303857,-1.300304,-1.296784,-1.293296,-1.289842,-1.286419,-1.283028,-1.279668,-1.276340,-1.273043,-1.269776,-1.266539,-1.263333,-1.260156,-1.257009,-1.253890,-1.250800,-1.247739,-1.244706,-1.241701,-1.238724,-1.235774,-1.232852,-1.229956,-1.227087,-1.224245,-1.221428,-1.218638,-1.215873,-1.213134,-1.210420,-1.207731,-1.205066,-1.202427,-1.199812,-1.197221,-1.194654,-1.192110,-1.189590,-1.187094,-1.184620,-1.182170,-1.179742,-1.177336,-1.174953,-1.172593,-1.170254,-1.167937,-1.165642,-1.163368,-1.161115,-1.158883,-1.156672,-1.154482,-1.152313,-1.150164,-1.148036,-1.145927,-1.143838,-1.141770,-1.139721,-1.137691,-1.135681,-1.133690,-1.131718,-1.129765,-1.127831,-1.125915,-1.124018,-1.122139,-1.120279,-1.118437,-1.116612,-1.114806,-1.113017,-1.111246,-1.109492,-1.107756,-1.106037,-1.104335,-1.102650,-1.100982,-1.099331,-1.097696,-1.096078,-1.094477,-1.092892,-1.091323,-1.089770,-1.088234,-1.086713,-1.085208,-1.083719,-1.082246,-1.080788,-1.079345,-1.077918,-1.076506,-1.075110,-1.073728,-1.072362,-1.071010,-1.069674,-1.068352,-1.067045,-1.065752,-1.064474,-1.063210,-1.061961,-1.060726,-1.059505,-1.058298,-1.057106,-1.055927,-1.054762,-1.053611,-1.052474,-1.051351,-1.050241,-1.049144,-1.048062,-1.046992,-1.045936,-1.044894,-1.043864,-1.042848,-1.041845,-1.040855,-1.039878,-1.038914,-1.037962,-1.037024,-1.036098,-1.035185,-1.034285,-1.033398,-1.032523,-1.031660,-1.030810,-1.029973,-1.029147,-1.028334,-1.027534,-1.026745,-1.025969,-1.025205,-1.024453,-1.023713,-1.022985,-1.022269,-1.021566,-1.020873,-1.020193,-1.019525,-1.018868,-1.018223,-1.017590,-1.016969,-1.016359,-1.015761,-1.015174,-1.014599,-1.014035,-1.013483,-1.012942,-1.012413,-1.011895,-1.011388,-1.010893,-1.010409,-1.009936,-1.009475,-1.009025,-1.008586,-1.008158,-1.007741,-1.007335,-1.006941,-1.006558,-1.006185,-1.005824,-1.005474,-1.005134,-1.004806,-1.004489,-1.004183,-1.003887,-1.003603,-1.003329,-1.003066,-1.002815,-1.002574,-1.002344,-1.002124,-1.001916,-1.001718,-1.001531,-1.001355,-1.001190,-1.001035,-1.000892,-1.000759,-1.000637,-1.000525,-1.000424,-1.000334,-1.000255,-1.000186,-1.000129,-1.000081,-1.000045,-1.000019,-1.000004,-1.000000,-1.000006,-1.000024,-1.000051,-1.000090,-1.000139,-1.000199,-1.000270,-1.000351,-1.000444,-1.000546,-1.000660,-1.000785,-1.000920,-1.001065,-1.001222,-1.001390,-1.001568,-1.001757,-1.001957,-1.002167,-1.002389,-1.002621,-1.002864,-1.003118,-1.003383,-1.003659,-1.003945,-1.004243,-1.004552,-1.004871,-1.005201,-1.005543,-1.005895,-1.006259,-1.006633,-1.007019,-1.007416,-1.007823,-1.008242,-1.008672,-1.009114,-1.009566,-1.010030,-1.010505,-1.010991,-1.011489,-1.011997,-1.012518,-1.013049,-1.013592,-1.014147,-1.014713,-1.015290,-1.015879,-1.016480,-1.017092,-1.017716,-1.018351,-1.018999,-1.019658,-1.020328,-1.021011,-1.021705,-1.022412,-1.023130,-1.023860,-1.024603,-1.025357,-1.026124,-1.026902,-1.027693,-1.028496,-1.029311,-1.030139,-1.030979,-1.031832,-1.032697,-1.033574,-1.034464,-1.035367,-1.036282,-1.037211,-1.038152,-1.039105,-1.040072,-1.041052,-1.042044,-1.043050,-1.044069,-1.045101,-1.046146,-1.047205,-1.048277,-1.049363,-1.050462,-1.051574,-1.052700,-1.053840,-1.054994,-1.056162,-1.057343,-1.058538,-1.059748,-1.060972,-1.062210,-1.063462,-1.064728,-1.066009,-1.067305,-1.068615,-1.069940,-1.071280,-1.072634,-1.074003,-1.075388,-1.076788,-1.078202,-1.079633,-1.081078,-1.082539,-1.084016,-1.085508,-1.087016,-1.088539,-1.090079,-1.091635,-1.093207,-1.094796,-1.096400,-1.098022,-1.099660,-1.101314,-1.102986,-1.104674,-1.106379,-1.108101,-1.109841,-1.111598,-1.113373,-1.115165,-1.116975,-1.118803,-1.120649,-1.122514,-1.124396,-1.126297,-1.128216,-1.130154,-1.132111,-1.134086,-1.136081,-1.138095,-1.140129,-1.142182,-1.144255,-1.146347,-1.148460,-1.150592,-1.152745,-1.154919,-1.157113,-1.159328,-1.161564,-1.163820,-1.166099,-1.168398,-1.170720,-1.173063,-1.175428,-1.177816,-1.180225,-1.182658,-1.185113,-1.187591,-1.190092,-1.192617,-1.195165,-1.197737,-1.200333,-1.202953,-1.205598,-1.208266,-1.210960,-1.213679,-1.216424,-1.219193,-1.221989,-1.224811,-1.227659,-1.230533,-1.233434,-1.236362,-1.239317,-1.242300,-1.245310,-1.248349,-1.251416,-1.254511,-1.257636,-1.260789,-1.263972,-1.267184,-1.270427,-1.273700,-1.277004,-1.280338,-1.283703,-1.287101,-1.290530,-1.293991,-1.297485,-1.301012,-1.304572,-1.308165,-1.311793,-1.315455,-1.319151,-1.322883,-1.326650,-1.330452,-1.334291,-1.338167,-1.342079,-1.346029,-1.350017,-1.354043,-1.358108,-1.362212,-1.366355,-1.370538,-1.374762,-1.379027,-1.383333,-1.387681,-1.392071,-1.396505,-1.400981,-1.405502,-1.410067,-1.414676,-1.419332,-1.424033,-1.428781,-1.433576,-1.438419,-1.443311,-1.448251,-1.453241,-1.458281,-1.463372,-1.468514,-1.473708,-1.478955,-1.484255,-1.489610,-1.495020,-1.500485,-1.506006,-1.511585,-1.517221,-1.522916,-1.528670,-1.534485,-1.540359,-1.546296,-1.552296,-1.558359,-1.564486,-1.570679,-1.576938,-1.583264,-1.589658,-1.596122,-1.602655,-1.609258,-1.615934,-1.622683,-1.629507,-1.636405,-1.643380,-1.650433,-1.657564,-1.664775,-1.672067,-1.679441,-1.686898,-1.694440,-1.702068,-1.709784,-1.717588,-1.725483,-1.733469,-1.741548,-1.749722,-1.757991,-1.766359,-1.774825,-1.783391,-1.792060,-1.800834,-1.809713,-1.818700,-1.827797,-1.837004,-1.846325,-1.855760,-1.865313,-1.874985,-1.884778,-1.894692,-1.904734,-1.914903,-1.925202,-1.935633,-1.946199,-1.956902,-1.967744,-1.978729,-1.989858,-2.001135,-2.012562,-2.024140,-2.035876,-2.047771,-2.059828,-2.072050,-2.084440,-2.097003,-2.109740,-2.122655,-2.135753,-2.149037,-2.162508,-2.176175,-2.190039,-2.204104,-2.218376,-2.232857,-2.247553,-2.262468,-2.277607,-2.292975,-2.308576,-2.324416,-2.340498,-2.356832,-2.373421,-2.390271,-2.407387,-2.424778,-2.442447,-2.460402,-2.478650,-2.497198,-2.516052,-2.535221,-2.554708,-2.574528,-2.594687,-2.615191,-2.636051,-2.657275,-2.678872,-2.700853,-2.723226,-2.746003,-2.769194,-2.792807,-2.816860,-2.841362,-2.866324,-2.891760,-2.917684,-2.944108,-2.971047,-2.998516,-3.026531,-3.055106,-3.084260,-3.114006,-3.144368,-3.175364,-3.207011,-3.239330,-3.272342,-3.306071,-3.340538,-3.375767,-3.411785,-3.448617,-3.486284,-3.524828,-3.564272,-3.604648,-3.645988,-3.688328,-3.731703,-3.776152,-3.821713,-3.868429,-3.916344,-3.965504,-4.015950,-4.067747,-4.120943,-4.175594,-4.231760,-4.289504,-4.348893,-4.409997,-4.472891,-4.537655,-4.604372,-4.673131,-4.744015,-4.817146,-4.892621,-4.970552,-5.051061,-5.134277,-5.220337,-5.309390,-5.401593,-5.497114,-5.596136,-5.698837,-5.805458,-5.916209,-6.031333,-6.151094,-6.275776,-6.405688,-6.541162,-6.682565,-6.830290,-6.984771,-7.146480,-7.315908,-7.493674,-7.680379,-7.876711,-8.083433,-8.301390,-8.531519,-8.774868,-9.032607,-9.306047,-9.596666,-9.906085,-10.236284,-10.589372,-10.967811,-11.374428,-11.812486,-12.285774,-12.798715,-13.356502,-13.965279,-14.632365,-15.366551,-16.178364,-17.081070,-18.090668,-19.227331,-20.516642,-21.991545,-23.695204,-25.685286,-28.040627,-30.871910,-34.339573,-38.685280,-44.289864,-51.795448,-62.364765,-78.354546,-105.372162,-160.830093,-339.530426,3055.439697};          // the hypontenuse


// F U N C T I O N S /////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////

void Timer(int clicks)
{
	// this function uses the internal time keeper timer i.e. the one that goes
	// at 18.2 clicks/sec to to a time delay.  You can find a 322 bit value of
	// this timer at 0000:046Ch

	unsigned int now;

	// get current time

	now = clock();

	// wait till time has gone past current time plus the amount we eanted to
	// wait.  Note each click is approx. 55 milliseconds.

	while (abs((long)(clock() - now)) < clicks) {}

} // end Timer

/////////////////////////////////////////////////////////////////////////////

void sline(long x1, long y1, long x2, long y2, int color)
{

	// used a a diagnostic function to draw a scaled line

	x1 = x1 / 4;
	y1 = 256 - (y1 / 4);

	x2 = x2 / 4;
	y2 = 256 - (y2 / 4);

	_setcolor(color);
	_moveto((int)x1, (int)y1);
	_lineto((int)x2, (int)y2);

} // end sline

/////////////////////////////////////////////////////////////////////////////

void splot(long x, long y, int color)
{
	// used as a diagnostic function to draw a scaled point

	x = x / 4;
	y = 256 - (y / 4);

	_setcolor(color);

	_setpixel((int)x, (int)y);
	_setpixel((int)x + 1, (int)y);
	_setpixel((int)x, (int)y + 1);
	_setpixel((int)x + 1, (int)y + 1);

} // end splot

/////////////////////////////////////////////////////////////////////////////

void Draw_2D_Map(void)
{
	// draw 2-D map of world

	int row, column, block, t, done = 0;

	for (row = 0; row < WORLD_ROWS; row++)
	{
		for (column = 0; column < WORLD_COLUMNS; column++)
		{

			block = world[row][column];

			// test if there is a solid block there

			if (block == 0)
			{

				_setcolor(253);
				_rectangle(_GBORDER, column * CELL_X_SIZE / 4, row * CELL_Y_SIZE / 4,
					column * CELL_X_SIZE / 4 + CELL_X_SIZE / 4 - 1, row * CELL_Y_SIZE / 4 + CELL_Y_SIZE / 4 - 1);

			}
			else
			{

				_setcolor(152);
				_rectangle(_GFILLINTERIOR, column * CELL_X_SIZE / 4, row * CELL_Y_SIZE / 4,
					column * CELL_X_SIZE / 4 + CELL_X_SIZE / 4 - 1, row * CELL_Y_SIZE / 4 + CELL_Y_SIZE / 4 - 1);

			}

		} // end for column

	} // end for row

} // end Draw_2D_Map

/////////////////////////////////////////////////////////////////////////////

void Ray_Caster(long x, long y, long view_angle)
{
	// This function casts out 320 rays from the viewer and builds up the video
	// display based on the intersections with the walls. The 320 rays are
	// cast in such a way that they all fit into a 60 degree field of view
	// a ray is cast and then the distance to the first horizontal and vertical
	// edge that has a cell in it is recorded.  The intersection that has the
	// closer distance to the user is the one that is used to draw the bitmap.
	// the distance is used to compute the height of the "sliver" of texture
	// or line that will be drawn on the screen

	// note: this function uses floating point (slow), no optimizations (slower)
	// and finally it makes calls to Microsofts Graphics libraries (slowest!)
	// however, writing it in this manner makes it many orders of magnitude
	// easier to understand.

	int rcolor;

	long xray = 0,        // tracks the progress of a ray looking for Y interesctions
		yray = 0,        // tracks the progress of a ray looking for X interesctions
		next_y_cell,   // used to figure out the quadrant of the ray
		next_x_cell,
		cell_x,        // the current cell that the ray is in
		cell_y,
		x_bound,       // the next vertical and horizontal intersection point
		y_bound,
		xb_save,       // storage to record intersections cell boundaries
		yb_save,
		x_delta,       // the amount needed to move to get to the next cell
		y_delta,       // position
		ray,           // the current ray being cast 0-320
		casting = 2,     // tracks the progress of the X and Y component of the ray
		x_hit_type,    // records the block that was intersected, used to figure
		y_hit_type,    // out which texture to use

		top,           // used to compute the top and bottom of the sliver that
		bottom;        // is drawn symetrically around the bisecting plane of the
	// screens vertical extents


	float xi,           // used to track the x and y intersections
		yi,
		xi_save,      // used to save exact x and y intersection points
		yi_save,
		dist_x,       // the distance of the x and y ray intersections from
		dist_y,       // the viewpoint
		scale;        // the final scale to draw the "sliver" in

	// S E C T I O N  1 /////////////////////////////////////////////////////////v

	// initialization

	// compute starting angle from player.  Field of view is 60 degrees, so
	// subtract half of that current view angle

	if ((view_angle -= ANGLE_30) < 0)
	{
		// wrap angle around
		view_angle = ANGLE_360 + view_angle;
	} // end if

	rcolor = 1 + rand() % 14;

	// loop through all 320 rays

	// section 2

	for (ray = 0; ray < 320; ray++)
	{

		// S E C T I O N  2 /////////////////////////////////////////////////////////

			// compute first x intersection

			// need to know which half plane we are casting from relative to Y axis

		if (view_angle >= ANGLE_0 && view_angle < ANGLE_180)
		{

			// compute first horizontal line that could be intersected with ray
			// note: it will be above player

			y_bound = CELL_Y_SIZE + CELL_Y_SIZE * (y / CELL_Y_SIZE);

			// compute delta to get to next horizontal line

			y_delta = CELL_Y_SIZE;

			// based on first possible horizontal intersection line, compute X
			// intercept, so that casting can begin

			xi = inv_tan_table[view_angle] * (y_bound - y) + x;

			// set cell delta

			next_y_cell = 0;

		} // end if upper half plane
		else
		{

			// compute first horizontal line that could be intersected with ray
			// note: it will be below player

			y_bound = CELL_Y_SIZE * (y / CELL_Y_SIZE);

			// compute delta to get to next horizontal line

			y_delta = -CELL_Y_SIZE;

			// based on first possible horizontal intersection line, compute X
			// intercept, so that casting can begin

			xi = inv_tan_table[view_angle] * (y_bound - y) + x;

			// set cell delta

			next_y_cell = -1;

		} // end else lower half plane


 // S E C T I O N  3 /////////////////////////////////////////////////////////

	 // compute first y intersection

	 // need to know which half plane we are casting from relative to X axis

		if (view_angle < ANGLE_90 || view_angle >= ANGLE_270)
		{

			// compute first vertical line that could be intersected with ray
			// note: it will be to the right of player

			x_bound = CELL_X_SIZE + CELL_X_SIZE * (x / CELL_X_SIZE);

			// compute delta to get to next vertical line

			x_delta = CELL_X_SIZE;

			// based on first possible vertical intersection line, compute Y
			// intercept, so that casting can begin

			yi = tan_table[view_angle] * (x_bound - x) + y;

			// set cell delta

			next_x_cell = 0;

		} // end if right half plane
		else
		{

			// compute first vertical line that could be intersected with ray
			// note: it will be to the left of player

			x_bound = CELL_X_SIZE * (x / CELL_X_SIZE);

			// compute delta to get to next vertical line

			x_delta = -CELL_X_SIZE;

			// based on first possible vertical intersection line, compute Y
			// intercept, so that casting can begin

			yi = tan_table[view_angle] * (x_bound - x) + y;

			// set cell delta

			next_x_cell = -1;

		} // end else right half plane

 // begin cast

		casting = 2;                // two rays to cast simultaneously
		xray = yray = 0;                // reset intersection flags


		// S E C T I O N  4 /////////////////////////////////////////////////////////

		while (casting)
		{

			// continue casting each ray in parallel

			if (xray != INTERSECTION_FOUND)
			{

				// test for asymtotic ray

				// if (view_angle==ANGLE_90 || view_angle==ANGLE_270)

				if (fabs(y_step[view_angle]) == 0)
				{
					xray = INTERSECTION_FOUND;
					casting--;
					dist_x = 1e+8;

				} // end if asymtotic ray

			 // compute current map position to inspect

				cell_x = ((x_bound + next_x_cell) / CELL_X_SIZE);
				cell_y = (long)(yi / CELL_Y_SIZE);

				// test if there is a block where the current x ray is intersecting

				//if ((x_hit_type = world[(WORLD_ROWS - 1) - cell_y][cell_x]) != 0)
				if (cell_x < 0) cell_x = 0;
				if (cell_x > WORLD_COLUMNS) cell_x = WORLD_COLUMNS - 1; 
				if (cell_y < 0) cell_y = 0; 
				if (cell_y > WORLD_ROWS) cell_y = WORLD_ROWS - 1;
				if ((x_hit_type = world[(WORLD_ROWS - 1) - cell_y][cell_x]) != 0)
				{
					// compute distance

					dist_x = (yi - y) * inv_sin_table[view_angle];
					yi_save = yi;
					xb_save = x_bound;

					// terminate X casting

					xray = INTERSECTION_FOUND;
					casting--;

				} // end if a hit
				else
				{
					// compute next Y intercept

					yi += y_step[view_angle];

				} // end else

			} // end if x ray has intersected

// S E C T I O N  5 /////////////////////////////////////////////////////////

			if (yray != INTERSECTION_FOUND)
			{

				// test for asymtotic ray

				// if (view_angle==ANGLE_0 || view_angle==ANGLE_180)

				if (fabs(x_step[view_angle]) == 0)
				{
					yray = INTERSECTION_FOUND;
					casting--;
					dist_y = 1e+8;

				} // end if asymtotic ray

			 // compute current map position to inspect

				cell_x = (long)(xi / CELL_X_SIZE);
				cell_y = ((y_bound + next_y_cell) / CELL_Y_SIZE);
								if (cell_x < 0) cell_x = 0;
				if (cell_x > WORLD_COLUMNS) cell_x = WORLD_COLUMNS - 1; 
				if (cell_y < 0) cell_y = 0; 
				if (cell_y > WORLD_ROWS) cell_y = WORLD_ROWS - 1;
				// test if there is a block where the current y ray is intersecting

				if ((y_hit_type = world[(WORLD_ROWS - 1) - cell_y][cell_x]) != 0)
				{
					// compute distance

					dist_y = (xi - x) * inv_cos_table[view_angle];
					xi_save = xi;
					yb_save = y_bound;

					// terminate Y casting

					yray = INTERSECTION_FOUND;
					casting--;

				} // end if a hit
				else
				{
					// compute next X intercept

					xi += x_step[view_angle];

				} // end else

			} // end if y ray has intersected

		 // move to next possible intersection points


			x_bound += x_delta;
			y_bound += y_delta;


			// _settextposition(38,40);
			// printf("x_bound = %ld, y_bound = %ld    ",x_bound,y_bound);

		} // end while not done


// S E C T I O N  6 /////////////////////////////////////////////////////////

	// at this point, we know that the ray has succesfully hit both a
	// vertical wall and a horizontal wall, so we need to see which one
	// was closer and then render it

	// note: latter we will replace the crude monochrome line with a sliver
	// of texture, but this is good enough for now

		if (dist_x < dist_y)
		{

			sline(x, y, (long)xb_save, (long)yi_save, rcolor);

			// there was a vertical wall closer than the horizontal

			// compute actual scale and multiply by view filter so that spherical
			// distortion is cancelled

			scale = cos_table[ray] * 15000 / (1e-10 + dist_x);

			// compute top and bottom and do a very crude clip

			if ((top = 100 - scale / 2) < 1)
				top = 1;

			if ((bottom = top + scale) > 200)
				bottom = 200;

			// draw wall sliver and place some dividers up

			if (((long)yi_save) % CELL_Y_SIZE <= 1)
				_setcolor(222);
			else
				_setcolor(221);

			_moveto((int)(638 - ray), (int)top);
			_lineto((int)(638 - ray), (int)bottom);

		}
		else // must of hit a horizontal wall first
		{

			sline(x, y, (long)xi_save, (long)yb_save, rcolor);

			// compute actual scale and multiply by view filter so that spherical
			// distortion is cancelled

			scale = cos_table[ray] * 15000 / (1e-10 + dist_y);

			// compute top and bottom and do a very crude clip

			if ((top = 100 - scale / 2) < 1)
				top = 1;

			if ((bottom = top + scale) > 200)
				bottom = 200;

			// draw wall sliver and place some dividers up

			if (((long)xi_save) % CELL_X_SIZE <= 1)
				_setcolor(215);
			else
				_setcolor(210);


			_moveto((int)(638 - ray), (int)top);
			_lineto((int)(638 - ray), (int)bottom);

		} // end else

 // S E C T I O N  7 /////////////////////////////////////////////////////////

	 // cast next ray

		if (++view_angle >= ANGLE_360)
		{
			// reset angle back to zero

			view_angle = 0;

		} // end if

	} // end for ray

} // end Ray_Caster



int _lineto(int x2, int y2) {
	int res = SDL_RenderDrawLine(renderer, global_x, global_y, x2, y2);
	if (res < 0) {
		SDL_ShowSimpleMessageBox(SDL_MESSAGEBOX_ERROR, "Couldn't create renderer!", SDL_GetError(), window);
	}

	_moveto(x2, y2);
	return 0;
}



void _setcolor(int new_color) {
	int sol = new_color % 3;

	int	b = (new_color >> 16) & 0xFF;
	int r = (new_color >> 8) & 0xFF;
	int g = new_color & 0xFF;

	if (sol == 1) {
		g = (new_color >> 16) & 0xFF;
		b = (new_color >> 8) & 0xFF;
		r = new_color & 0xFF;
	}
	if (sol == 2) {
		r = (new_color >> 16) & 0xFF;
		g = (new_color >> 8) & 0xFF;
		b = new_color & 0xFF;
	}

	SDL_SetRenderDrawColor(renderer, r, g, b, 255);
}

int _setpixel(int x, int y) {
	SDL_RenderDrawPoint(renderer, x, y);
	return 0;
}

void _moveto(int x1, int y1) {
	global_x = x1;
	global_y = y1;
}

int _rectangle(int border, int x1, int y1, int x2, int y2) {

	if (border) {
		SDL_Rect rect;
		rect.x = x1;
		rect.y = y1;
		rect.h = y2 - y1;
		rect.w = x2 - x1;
		return SDL_RenderDrawRect(renderer, &rect);
	}
	else
	{
		SDL_Rect rect;
		rect.x = x1;
		rect.y = y1;
		rect.h = y2 - y1;
		rect.w = x2 - x1;
		return SDL_RenderFillRect(renderer, &rect);
	}
}

int  main(void)
{

	int row, column, block, t, done = 0;

	long x, y, view_angle, x_cell, y_cell, x_sub_cell, y_sub_cell;

	float dx, dy;


	// seed random number genrerator

	srand(13);

	// set mode to 640x480 so we can fit a lot of info on the screen for
	// educational purposes


	 //Initialize SDL
	if (SDL_Init(SDL_INIT_VIDEO) < 0)
	{
		printf("SDL could not initialize! SDL_Error: %s\n", SDL_GetError());
		return 0;
	}
	else
	{


		//Create window
		window = SDL_CreateWindow("SDL Tutorial", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, SCREEN_WIDTH, SCREEN_HEIGHT, SDL_WINDOW_SHOWN);
		if (window == NULL)
		{
			printf("Window could not be created! SDL_Error: %s\n", SDL_GetError());
			return 0;
		}
		else
		{

			SDL_CreateWindowAndRenderer(640, 480, SDL_WINDOW_RESIZABLE, &window, &renderer);

			if (!renderer) {
				printf("Failed to create window and renderer:   %s\n", SDL_GetError());
				return 0;
			}
			// Initialize SDL_ttf
			if (TTF_Init() < 0) {
				printf("Error intializing SDL_ttf: %s\n", SDL_GetError());
				return false;
			}
			// Load font
			font = TTF_OpenFont("C:\\_Development\\sdl\\Arial.ttf", 12);
			if (!font) {
				printf("TTF  %s\n", SDL_GetError());
				return false;
			}


			// draw top view of world

			Draw_2D_Map();

			SDL_RenderPresent(renderer);

			// draw information prompts

			_settextposition(18, 8);

			tprintf("2-D Map View");

			_settextposition(16, 54);

			tprintf("3-D Projection");

			_settextposition(35, 16);

			tprintf("Use numeric keypad to move. Press Q to quit.");

			// draw window around view port

			_setcolor(115);
			_rectangle(_GBORDER, 318, 0, 639, 201);

			x = 8 * 64 + 25;
			y = 3 * 64 + 25;
			view_angle = ANGLE_60;

			// render initial view

			Ray_Caster(x, y, view_angle);
			SDL_RenderPresent(renderer);

			bool KEYS[322];  // 322 is the number of SDLK_DOWN events

			for (int i = 0; i < 322; i++) { // init them all to false
				KEYS[i] = false;
			}



			// wait for user to press q to quit

			while (!done)
			{

				// has keyboard been hit?


				SDL_Event event; bool quit = false;
				while (quit == false)
				{
					while (SDL_PollEvent(&event))
					{
						switch (event.type) {
							// exit if the window is closed
						case SDL_QUIT:
							quit = true; // set game state to done,(do what you want here)
							break;
							// check for keypresses
						case SDL_KEYDOWN:
							KEYS[event.key.keysym.sym] = true;
							break;
						case SDL_KEYUP:
							KEYS[event.key.keysym.sym] = false;
							break;
						default:
							break;
						}


						if (event.type == SDL_KEYDOWN) {
							// reset deltas

							dx = dy = 0;

							// clear viewport

							_setcolor(0);
							_rectangle(_GFILLINTERIOR, 319, 1, 638, 200);
							_setcolor(118);
							_rectangle(_GFILLINTERIOR, 319, 100, 638, 200);
							Draw_2D_Map();
							// what is user doing

							if (KEYS[SDLK_6]) {

								if ((view_angle -= ANGLE_6) < ANGLE_0)
									view_angle = ANGLE_360;

							}

							if (KEYS[SDLK_4])
							{
								if ((view_angle += ANGLE_6) >= ANGLE_360)
									view_angle = ANGLE_0;

							}


							if (KEYS[SDLK_8])
							{

								// move player along view vector foward

								dx = cos(6.28 * view_angle / ANGLE_360) * 10;
								dy = sin(6.28 * view_angle / ANGLE_360) * 10;

							}

							if (KEYS[SDLK_2])
							{
								// move player along view vector backward

								dx = -cos(6.28 * view_angle / ANGLE_360) * 10;
								dy = -sin(6.28 * view_angle / ANGLE_360) * 10;

								// test if player is bumping into a wall

							}


							if (KEYS[SDLK_q]) { done = 1; quit = true; }


							// move player

							x += dx;
							y += dy;

							// test if user has bumped into a wall i.e. test if there
							// is a cell within the direction of motion, if so back up !

							// compute cell position

							x_cell = x / CELL_X_SIZE;
							y_cell = y / CELL_Y_SIZE;

							// compute position relative to cell

							x_sub_cell = x % CELL_X_SIZE;
							y_sub_cell = y % CELL_Y_SIZE;


							// resolve motion into it's x and y components

							if (dx > 0)
							{
								// moving right

								if ((world[(WORLD_ROWS - 1) - y_cell][x_cell + 1] != 0) &&
									(x_sub_cell > (CELL_X_SIZE - OVERBOARD)))
								{
									// back player up amount he steped over the line

									x -= (x_sub_cell - (CELL_X_SIZE - OVERBOARD));

								} // end if need to back up

							}
							else
							{
								// moving left

								if ((world[(WORLD_ROWS - 1) - y_cell][x_cell - 1] != 0) &&
									(x_sub_cell < (OVERBOARD)))
								{
									// back player up amount he steped over the line

									x += (OVERBOARD - x_sub_cell);

								} // end if need to back up

							} // end else

							if (dy > 0)
							{
								// moving up

								if ((world[(WORLD_ROWS - 1) - (y_cell + 1)][x_cell] != 0) &&
									(y_sub_cell > (CELL_Y_SIZE - OVERBOARD)))
								{
									// back player up amount he steped over the line

									y -= (y_sub_cell - (CELL_Y_SIZE - OVERBOARD));

								} // end if need to back up
							}
							else
							{
								// moving down

								if ((world[(WORLD_ROWS - 1) - (y_cell - 1)][x_cell] != 0) &&
									(y_sub_cell < (OVERBOARD)))
								{
									// back player up amount he steped over the line

									y += (OVERBOARD - y_sub_cell);

								} // end if need to back up

							} // end else

						 // render the view

							Ray_Caster(x, y, view_angle);

							// display status

							_settextposition(20, 1);
							char my_str[1024];
							sprintf(my_str + strlen(my_str), "\nPosition of player is (%ld,%ld)   ", x, y);
							sprintf(my_str + strlen(my_str), "\nView angle is %ld  ", (long)(360 * (float)view_angle / ANGLE_360));
							sprintf(my_str + strlen(my_str), "\nCurrent cell is (%ld,%ld)   ", x_cell, y_cell);
							sprintf(my_str + strlen(my_str), "\nRelative position within cell is (%ld,%ld)  ", x_sub_cell, y_sub_cell);
							tprintf(my_str);
							SDL_RenderPresent(renderer);
						}

					}
				}




			} //end while

				//Destroy window
			SDL_DestroyWindow(window);

			//Quit SDL subsystems
			SDL_Quit();

			return 0;
		}
	}
} // end main


int _settextposition(int x1, int y1)
{
	text_x = x1; text_y = y1;
	return 0;
}

void tprintf(const char* input) {
	// Render texture
	SDL_Rect dest;
	SDL_RenderCopy(renderer, texture, NULL, NULL);

	SDL_Color foreground = { 255, 255, 255 };

	SDL_Surface* text_surf = TTF_RenderText_Solid(font, input, foreground);
	text = SDL_CreateTextureFromSurface(renderer, text_surf);

	dest.x = 320 - (text_surf->w / 2.0f);
	dest.y = 240;
	dest.w = text_surf->w;
	dest.h = text_surf->h;
	SDL_RenderCopy(renderer, text, NULL, &dest);
	SDL_RenderPresent(renderer);

	SDL_DestroyTexture(text);
	SDL_FreeSurface(text_surf);
	SDL_RenderPresent(renderer);

}